{"ast":null,"code":"import React,{useState,useEffect}from'react';import{parseVND,formatVND}from'../utils/currency';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ProductItem(_ref){let{product,addToCart}=_ref;const[displaySettings,setDisplaySettings]=useState({show_rating:true,show_sold:true});useEffect(()=>{axios.get('/api/settings').then(response=>{if(response.data&&typeof response.data==='object'){const settings={};Object.keys(response.data).forEach(key=>{settings[key]=response.data[key].value||'';});setDisplaySettings({show_rating:settings['display.show_rating']==='true',show_sold:settings['display.show_sold']==='true'});}}).catch(error=>{console.error('Error fetching display settings:',error);});},[]);const handleAddToCart=e=>{e.preventDefault();addToCart(product);// Gọi hàm addToCart khi nhấn nút\n};// Price formatting (VN)\nconst priceNumber=parseVND(product.price);const priceFormatted=formatVND(priceNumber);// Helpers for stars and sold\nconst renderStars=function(){let rating=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;const full=Math.floor(rating);const half=rating%1>=0.5?1:0;const empty=5-full-half;const stars=[];for(let i=0;i<full;i++)stars.push(/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-star\"},`f${i}`));if(half)stars.push(/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-star-half-alt\"},\"h\"));for(let i=0;i<empty;i++)stars.push(/*#__PURE__*/_jsx(\"i\",{className:\"far fa-star\"},`e${i}`));return stars;};const formatSold=function(){let n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(n>=1000)return Math.round(n/1000*10)/10+'k';return String(n);};return/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-2 col-md-3 col-sm-6 pb-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card product-item border-0 mb-4\",children:[/*#__PURE__*/_jsxs(\"a\",{href:`/shopdetail/${product.id}`,className:\"card-header product-img position-relative overflow-hidden bg-transparent border p-0 d-block\",children:[Number(product===null||product===void 0?void 0:product.discount)>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"product-badge badge-sale\",children:[\"-\",product.discount,\"%\"]}),!!(product!==null&&product!==void 0&&product.isNew)&&!(Number(product===null||product===void 0?void 0:product.discount)>0)&&/*#__PURE__*/_jsx(\"span\",{className:\"product-badge badge-new\",children:\"M\\u1EDBi\"}),/*#__PURE__*/_jsx(\"img\",{className:\"img-fluid w-100\",src:product.img,alt:product.name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body border-left border-right text-center p-0 pt-4 pb-3\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"product-title mb-2\",children:/*#__PURE__*/_jsx(\"a\",{href:`/shopdetail/${product.id}`,className:\"text-dark\",children:product.name})}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(\"h6\",{children:priceFormatted})}),(displaySettings.show_rating||displaySettings.show_sold)&&/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-center align-items-center gap-2 mt-1\",style:{columnGap:'8px'},children:[displaySettings.show_rating&&Number(product.rating_count)>0&&/*#__PURE__*/_jsx(\"div\",{className:\"rating-stars text-warning\",\"aria-label\":`Đánh giá ${Number(product.rating)} trên 5`,children:renderStars(Number(product.rating)||0)}),displaySettings.show_sold&&/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[\"\\u0110\\xE3 b\\xE1n \",formatSold(Number(product.sold)||0)]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-footer d-flex justify-content-between bg-light border\",children:[/*#__PURE__*/_jsxs(\"a\",{href:\"/\",className:\"btn btn-sm text-dark p-0\",onClick:handleAddToCart,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-shopping-cart text-primary mr-1\"}),\"Th\\xEAm v\\xE0o gi\\u1ECF h\\xE0ng\"]}),/*#__PURE__*/_jsxs(\"a\",{href:`/shopdetail/${product.id}`,className:\"btn btn-sm text-dark p-0\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-eye text-primary mr-1\"}),\" Chi ti\\u1EBFt\"]})]})]})});}export default ProductItem;","map":{"version":3,"names":["React","useState","useEffect","parseVND","formatVND","axios","jsx","_jsx","jsxs","_jsxs","ProductItem","_ref","product","addToCart","displaySettings","setDisplaySettings","show_rating","show_sold","get","then","response","data","settings","Object","keys","forEach","key","value","catch","error","console","handleAddToCart","e","preventDefault","priceNumber","price","priceFormatted","renderStars","rating","arguments","length","undefined","full","Math","floor","half","empty","stars","i","push","className","formatSold","n","round","String","children","href","id","Number","discount","isNew","src","img","alt","name","style","columnGap","rating_count","sold","onClick"],"sources":["C:/Trần Minh Quý/Chuyên đề Nodejs và React/2200008995_TranMinhQuy/2200008995_TranMinhQuy/ProjectReactNodejs/SHOPBANSACH/frontend/src/pages/productItem.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { parseVND, formatVND } from '../utils/currency';\nimport axios from 'axios';\n\nfunction ProductItem({ product, addToCart }) {\n    const [displaySettings, setDisplaySettings] = useState({\n        show_rating: true,\n        show_sold: true\n    });\n\n    useEffect(() => {\n        axios.get('/api/settings')\n            .then(response => {\n                if (response.data && typeof response.data === 'object') {\n                    const settings = {};\n                    Object.keys(response.data).forEach(key => {\n                        settings[key] = response.data[key].value || '';\n                    });\n                    setDisplaySettings({\n                        show_rating: settings['display.show_rating'] === 'true',\n                        show_sold: settings['display.show_sold'] === 'true'\n                    });\n                }\n            })\n            .catch(error => {\n                console.error('Error fetching display settings:', error);\n            });\n    }, []);\n    const handleAddToCart = (e) => {\n        e.preventDefault();\n        addToCart(product); // Gọi hàm addToCart khi nhấn nút\n     \n    };\n\n    // Price formatting (VN)\n    const priceNumber = parseVND(product.price);\n    const priceFormatted = formatVND(priceNumber);\n\n    // Helpers for stars and sold\n    const renderStars = (rating = 0) => {\n        const full = Math.floor(rating);\n        const half = rating % 1 >= 0.5 ? 1 : 0;\n        const empty = 5 - full - half;\n        const stars = [];\n        for (let i = 0; i < full; i++) stars.push(<i key={`f${i}`} className=\"fas fa-star\"></i>);\n        if (half) stars.push(<i key=\"h\" className=\"fas fa-star-half-alt\"></i>);\n        for (let i = 0; i < empty; i++) stars.push(<i key={`e${i}`} className=\"far fa-star\"></i>);\n        return stars;\n    };\n\n    const formatSold = (n = 0) => {\n        if (n >= 1000) return (Math.round((n / 1000) * 10) / 10) + 'k';\n        return String(n);\n    };\n\n    return (\n        <div className=\"col-lg-2 col-md-3 col-sm-6 pb-1\">\n            <div className=\"card product-item border-0 mb-4\">\n                <a href={`/shopdetail/${product.id}`} className=\"card-header product-img position-relative overflow-hidden bg-transparent border p-0 d-block\">\n                    {/* Optional badge */}\n                    {Number(product?.discount) > 0 && (\n                        <span className=\"product-badge badge-sale\">-{product.discount}%</span>\n                    )}\n                    {!!product?.isNew && !(Number(product?.discount) > 0) && (\n                        <span className=\"product-badge badge-new\">Mới</span>\n                    )}\n                    <img className=\"img-fluid w-100\" src={product.img} alt={product.name} />\n                </a>\n                <div className=\"card-body border-left border-right text-center p-0 pt-4 pb-3\">\n                    <h6 className=\"product-title mb-2\"><a href={`/shopdetail/${product.id}`} className=\"text-dark\">{product.name}</a></h6>\n                    <div className=\"d-flex justify-content-center\">\n                        <h6>{priceFormatted}</h6>\n                    </div>\n                    {(displaySettings.show_rating || displaySettings.show_sold) && (\n                        <div className=\"d-flex justify-content-center align-items-center gap-2 mt-1\" style={{columnGap:'8px'}}>\n                            {displaySettings.show_rating && Number(product.rating_count) > 0 && (\n                                <div className=\"rating-stars text-warning\" aria-label={`Đánh giá ${Number(product.rating)} trên 5`}>\n                                    {renderStars(Number(product.rating) || 0)}\n                                </div>\n                            )}\n                            {displaySettings.show_sold && (\n                                <small className=\"text-muted\">Đã bán {formatSold(Number(product.sold) || 0)}</small>\n                            )}\n                        </div>\n                    )}\n                </div>\n                <div className=\"card-footer d-flex justify-content-between bg-light border\">\n                    <a href=\"/\" className=\"btn btn-sm text-dark p-0\"\n                        onClick={handleAddToCart}>\n                        <i className=\"fas fa-shopping-cart text-primary mr-1\"></i>\n                        Thêm vào giỏ hàng\n                    </a>\n                    <a href={`/shopdetail/${product.id}`} className=\"btn btn-sm text-dark p-0\">\n                        <i className=\"fas fa-eye text-primary mr-1\"></i> Chi tiết\n                    </a>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default ProductItem;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}