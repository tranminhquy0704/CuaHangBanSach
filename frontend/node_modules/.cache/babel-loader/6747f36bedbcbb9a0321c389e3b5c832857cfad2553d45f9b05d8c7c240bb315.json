{"ast":null,"code":"import React,{Fragment,useEffect,useState}from\"react\";import{useNavigate,Link}from'react-router-dom';import Header from\"./Header\";import Footer from\"./Footer\";import axios from'axios';import{parseVND,formatVND}from'../utils/currency';import{toast}from'react-toastify';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Checkout(){// Khai báo các biến trạng thái\nconst[cartItems,setCartItems]=useState([]);// Danh sách sản phẩm trong giỏ hàng\nconst[formData,setFormData]=useState({fullName:'',// Họ và tên\nmobile:'',// Số điện thoại\naddress:'',// Địa chỉ\nstate:'',// Tỉnh/Thành phố\npaymentMethod:'',// Phương thức thanh toán\nnote:''// Ghi chú (tùy chọn)\n});const[errors,setErrors]=useState({});const[shippingSettings,setShippingSettings]=useState({fee:30000,free_threshold:500000,delivery_days:3,areas:'Toàn quốc'});const[promoSettings,setPromoSettings]=useState({bulk_discount:0,bulk_threshold:5,enable_voucher:false});const[paymentSettings,setPaymentSettings]=useState({enable_cod:true,enable_bank:false,enable_ewallet:false,bank_info:''});const[voucherCode,setVoucherCode]=useState('');const[voucherDiscount,setVoucherDiscount]=useState(0);const[voucherError,setVoucherError]=useState('');const[myVouchers,setMyVouchers]=useState([]);const[selectedUserVoucherId,setSelectedUserVoucherId]=useState(null);const[loadingMyVouchers,setLoadingMyVouchers]=useState(false);const[hasAuthToken,setHasAuthToken]=useState(!!localStorage.getItem('token'));const navigate=useNavigate();const popularProvinces=['Hồ Chí Minh','Hà Nội','Đà Nẵng','Cần Thơ','Bình Dương','Đồng Nai','Hải Phòng'];const otherProvinces=['An Giang','Bà Rịa - Vũng Tàu','Bắc Giang','Bắc Kạn','Bạc Liêu','Bắc Ninh','Bến Tre','Bình Định','Bình Phước','Bình Thuận','Cà Mau','Cao Bằng','Đắk Lắk','Đắk Nông','Điện Biên','Đồng Tháp','Gia Lai','Hà Giang','Hà Nam','Hà Tĩnh','Hải Dương','Hậu Giang','Hòa Bình','Hưng Yên','Khánh Hòa','Kiên Giang','Kon Tum','Lai Châu','Lâm Đồng','Lạng Sơn','Lào Cai','Long An','Nam Định','Nghệ An','Ninh Bình','Ninh Thuận','Phú Thọ','Phú Yên','Quảng Bình','Quảng Nam','Quảng Ngãi','Quảng Ninh','Quảng Trị','Sóc Trăng','Sơn La','Tây Ninh','Thái Bình','Thái Nguyên','Thanh Hóa','Thừa Thiên Huế','Tiền Giang','Trà Vinh','Tuyên Quang','Vĩnh Long','Vĩnh Phúc','Yên Bái'];// Sử dụng useEffect để lấy giỏ hàng từ localStorage \nuseEffect(()=>{const storedCart=localStorage.getItem(\"cart\");if(storedCart){setCartItems(JSON.parse(storedCart));}// Khôi phục phương thức thanh toán\nconst savedMethod=localStorage.getItem('paymentMethod');if(savedMethod){setFormData(prev=>({...prev,paymentMethod:savedMethod}));}else{// default chọn COD nếu được bật, nếu không thì chọn phương thức đầu tiên có sẵn\n// Sẽ được set sau khi load settings\n}// Khôi phục dữ liệu form\nconst savedForm=localStorage.getItem('checkoutForm');if(savedForm){try{const parsed=JSON.parse(savedForm);// Ignore any legacy `email` stored previously\nif(parsed&&parsed.email)delete parsed.email;setFormData(prev=>({...prev,...parsed}));}catch{}}// Fetch settings\naxios.get('/api/settings').then(response=>{if(response.data&&typeof response.data==='object'){const settings={};Object.keys(response.data).forEach(key=>{settings[key]=response.data[key].value||'';});setShippingSettings({fee:parseInt(settings['shipping.fee'])||30000,free_threshold:parseInt(settings['shipping.free_threshold'])||500000,delivery_days:parseInt(settings['shipping.delivery_days'])||3,areas:settings['shipping.areas']||'Toàn quốc'});setPromoSettings({bulk_discount:parseInt(settings['promo.bulk_discount'])||0,bulk_threshold:parseInt(settings['promo.bulk_threshold'])||5,enable_voucher:settings['promo.enable_voucher']==='true'});const paymentSettings={enable_cod:settings['payment.enable_cod']==='true',enable_bank:settings['payment.enable_bank']==='true',enable_ewallet:settings['payment.enable_ewallet']==='true',bank_info:settings['payment.bank_info']||''};setPaymentSettings(paymentSettings);// Set default payment method if not set\nif(!formData.paymentMethod){if(paymentSettings.enable_cod){setFormData(prev=>({...prev,paymentMethod:'cod'}));}else if(paymentSettings.enable_bank){setFormData(prev=>({...prev,paymentMethod:'banktransfer'}));}else if(paymentSettings.enable_ewallet){setFormData(prev=>({...prev,paymentMethod:'ewallet'}));}}}}).catch(error=>{console.error('Error fetching settings:',error);});const token=localStorage.getItem('token');setHasAuthToken(!!token);if(token){setLoadingMyVouchers(true);axios.get('/api/my-vouchers',{headers:{'Authorization':`Bearer ${token}`}}).then(response=>{setMyVouchers(Array.isArray(response.data)?response.data:[]);}).catch(error=>{console.error('Error fetching my vouchers:',error);}).finally(()=>setLoadingMyVouchers(false));}},[]);// Hàm tính tổng phụ (subtotal) của giỏ hàng - chuẩn hoá giá VND\nconst getSubtotal=()=>{return cartItems.reduce((total,item)=>{const unit=parseVND(item.price);return total+unit*(item.quantity||1);},0);};// Tính tổng số lượng sản phẩm\nconst getTotalQuantity=()=>{return cartItems.reduce((total,item)=>total+(item.quantity||1),0);};// Tính giảm giá khi mua nhiều\nconst getBulkDiscount=()=>{const totalQty=getTotalQuantity();if(totalQty>=promoSettings.bulk_threshold&&promoSettings.bulk_discount>0){const subtotal=getSubtotal();return Math.round(subtotal*promoSettings.bulk_discount/100);}return 0;};// Xử lý áp dụng voucher\nconst handleApplyVoucher=async function(){var _ref;let codeOverride=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const candidate=(_ref=codeOverride!==null&&codeOverride!==void 0?codeOverride:voucherCode)!==null&&_ref!==void 0?_ref:'';const effectiveCode=String(candidate).trim();if(!effectiveCode){setVoucherError('Vui lòng nhập mã voucher');return;}try{const response=await axios.post('/api/vouchers/validate',{code:effectiveCode});const voucher=response.data;const subtotal=getSubtotal()-getBulkDiscount();// Check minimum order amount\nif(subtotal<voucher.min_order_amount){setVoucherError(`Đơn hàng tối thiểu ${formatVND(voucher.min_order_amount)} để sử dụng voucher này`);setVoucherDiscount(0);if(!options.silent)toast.info('Giá trị đơn hàng chưa đạt điều kiện voucher');return;}// Calculate discount\nlet discount=0;if(voucher.discount_type==='percent'){discount=Math.round(subtotal*voucher.discount_value/100);if(voucher.max_discount&&discount>voucher.max_discount){discount=voucher.max_discount;}}else{discount=voucher.discount_value;}setVoucherDiscount(discount);setVoucherError('');setVoucherCode(effectiveCode);if(options.userVoucherId){setSelectedUserVoucherId(options.userVoucherId);}else if(!options.keepSelection){setSelectedUserVoucherId(null);}if(!options.silent)toast.success('Áp dụng voucher thành công!');}catch(error){var _error$response,_error$response$data;setVoucherError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Mã voucher không hợp lệ');setVoucherDiscount(0);if(!options.silent)toast.error('Áp dụng voucher thất bại');}};const handleSelectSavedVoucher=voucher=>{if(!voucher||voucher.is_used){toast.info('Voucher đã được sử dụng');return;}handleApplyVoucher(voucher.code,{userVoucherId:voucher.user_voucher_id,keepSelection:true});};// Tính tổng giảm giá (bulk + voucher)\nconst getTotalDiscount=()=>{return getBulkDiscount()+voucherDiscount;};const availableSavedVouchers=myVouchers.filter(v=>!v.is_used);// Hàm tính phí vận chuyển (tính sau khi trừ giảm giá)\nconst getShippingFee=()=>{const subtotalAfterDiscount=getSubtotal()-getTotalDiscount();if(subtotalAfterDiscount>=shippingSettings.free_threshold){return 0;// Miễn phí ship\n}return shippingSettings.fee||0;};// Hàm tính tổng cộng (total) của giỏ hàng\nconst getTotal=()=>{return getSubtotal()-getTotalDiscount()+getShippingFee();};// Hàm xử lý thay đổi dữ liệu trong form\nconst handleInputChange=e=>{const{name,value}=e.target;const next={...formData,[name]:value};setFormData(next);// Lưu localStorage\nif(name==='paymentMethod')localStorage.setItem('paymentMethod',value);localStorage.setItem('checkoutForm',JSON.stringify({fullName:next.fullName,mobile:next.mobile,address:next.address,state:next.state,note:next.note}));// Validate nhanh từng trường\nvalidateField(name,value);};const validateField=(name,value)=>{let msg='';if(['fullName','mobile','address','state'].includes(name)&&!value.trim())msg='Vui lòng nhập thông tin.';if(name==='mobile'){const phoneOk=/^(0[3|5|7|8|9])[0-9]{8}$/.test(value.replace(/\\s+/g,''));if(!phoneOk)msg='Số điện thoại VN không hợp lệ.';}setErrors(prev=>({...prev,[name]:msg}));};const validateForm=()=>{const fields=['fullName','mobile','address','state'];const newErrors={};fields.forEach(f=>validateField(f,formData[f]));fields.forEach(f=>{if(!formData[f]||errors[f]&&errors[f].length)newErrors[f]=errors[f]||'Vui lòng nhập thông tin.';});setErrors(prev=>({...prev,...newErrors}));const hasError=fields.some(f=>newErrors[f]);return!hasError;};// Hàm xử lý đặt hàng\nconst handlePlaceOrder=async()=>{// Kiểm tra nếu giỏ hàng trống\nif(cartItems.length===0){toast.info('Giỏ hàng trống. Vui lòng thêm sản phẩm trước khi thanh toán.');return;}// Validate form giao hàng\nif(!validateForm()){toast.info('Vui lòng kiểm tra lại thông tin giao hàng.');return;}try{var _resp$data;// Tạo dữ liệu đơn hàng\nconst orderData={// Do not send email field anymore\nfullName:formData.fullName,mobile:formData.mobile,address:formData.address,state:formData.state,paymentMethod:formData.paymentMethod,note:formData.note,cartItems,total:getTotal(),voucherCode:voucherCode?voucherCode.trim().toUpperCase():null,userVoucherId:selectedUserVoucherId};// Gửi dữ liệu đơn hàng lên server\nconst token=localStorage.getItem('token');const headers=token?{'Authorization':`Bearer ${token}`}:{};const resp=await axios.post('/api/orders',orderData,{headers});const updatedSold=resp===null||resp===void 0?void 0:(_resp$data=resp.data)===null||_resp$data===void 0?void 0:_resp$data.updatedSold;toast.success(`Đặt hàng thành công!${typeof updatedSold==='number'?` (cập nhật ${updatedSold} sản phẩm)`:''}`);localStorage.removeItem('cart');// Xóa giỏ hàng sau khi đặt hàng thành công\n// Giữ lại thông tin người nhận cho lần sau, chỉ xóa ghi chú\nconst kept={...formData,note:''};localStorage.setItem('checkoutForm',JSON.stringify({fullName:kept.fullName,mobile:kept.mobile,address:kept.address,state:kept.state,note:kept.note}));// Điều hướng về trang Cửa hàng để refetch dữ liệu và thấy \"Đã bán\" cập nhật\nsetTimeout(()=>navigate('/shop'),300);}catch(error){console.error('Error placing order:',error);toast.error('Có lỗi xảy ra khi đặt hàng. Vui lòng thử lại.');}};return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid bg-secondary mb-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column align-items-center justify-content-center\",style:{minHeight:'300px'},children:[/*#__PURE__*/_jsx(\"h1\",{className:\"font-weight-semi-bold text-uppercase mb-3\",children:\"Thanh to\\xE1n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-inline-flex\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"m-0\",children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Trang ch\\u1EE7\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"m-0 px-2\",children:\"-\"}),/*#__PURE__*/_jsx(\"p\",{className:\"m-0\",children:\"Thanh to\\xE1n\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid pt-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row px-xl-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-weight-semi-bold mb-4\",children:\"Th\\xF4ng tin giao h\\xE0ng\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6 form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"H\\u1ECD v\\xE0 t\\xEAn\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control\",type:\"text\",name:\"fullName\",value:formData.fullName,onChange:handleInputChange}),errors.fullName&&/*#__PURE__*/_jsx(\"small\",{className:\"text-danger\",children:errors.fullName})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6 form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control\",type:\"text\",name:\"mobile\",value:formData.mobile,onChange:handleInputChange}),errors.mobile&&/*#__PURE__*/_jsx(\"small\",{className:\"text-danger\",children:errors.mobile})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6 form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0110\\u1ECBa ch\\u1EC9\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control\",type:\"text\",name:\"address\",value:formData.address,onChange:handleInputChange}),errors.address&&/*#__PURE__*/_jsx(\"small\",{className:\"text-danger\",children:errors.address})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6 form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"T\\u1EC9nh/Th\\xE0nh \",/*#__PURE__*/_jsx(\"span\",{className:\"text-danger\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-control\",name:\"state\",value:formData.state,onChange:handleInputChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,children:\"Ch\\u1ECDn T\\u1EC9nh/Th\\xE0nh n\\u01A1i nh\\u1EADn h\\xE0ng\"}),/*#__PURE__*/_jsx(\"optgroup\",{label:\"Ph\\u1ED5 bi\\u1EBFn\",children:popularProvinces.map(p=>/*#__PURE__*/_jsx(\"option\",{value:p,children:p},p))}),/*#__PURE__*/_jsx(\"optgroup\",{label:\"Kh\\xE1c\",children:otherProvinces.map(p=>/*#__PURE__*/_jsx(\"option\",{value:p,children:p},p))})]}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Ch\\u1ECDn t\\u1EC9nh/th\\xE0nh \\u0111\\u1EC3 \\u0111\\u1EA3m b\\u1EA3o giao \\u0111\\xFAng khu v\\u1EF1c.\"}),/*#__PURE__*/_jsx(\"br\",{}),errors.state&&/*#__PURE__*/_jsx(\"small\",{className:\"text-danger\",children:errors.state})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6 form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Ghi ch\\xFA (t\\xF9y ch\\u1ECDn)\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control\",rows:\"1\",name:\"note\",value:formData.note,onChange:handleInputChange})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-lg-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card border-0 shadow-sm mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header bg-light border-0 text-center\",children:/*#__PURE__*/_jsx(\"h4\",{className:\"font-weight-semi-bold m-0 text-uppercase\",children:\"T\\u1ED5ng \\u0111\\u01A1n h\\xE0ng\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-3\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-uppercase text-muted mb-0\",children:\"S\\u1EA3n ph\\u1EA9m\"}),/*#__PURE__*/_jsx(Link,{to:\"/cart\",className:\"small text-decoration-none\",children:\"Ch\\u1EC9nh s\\u1EEDa gi\\u1ECF h\\xE0ng\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"order-items-list border rounded p-3 mb-3\",style:{maxHeight:'240px',overflowY:'auto',backgroundColor:'#fdfdfd'},children:cartItems.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"py-1\",style:{display:'grid',gridTemplateColumns:'1fr auto',alignItems:'center',width:'100%'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-truncate\",style:{whiteSpace:'nowrap',textAlign:'left'},title:item.name,children:[/*#__PURE__*/_jsx(\"span\",{className:\"fw-semibold\",children:item.name}),/*#__PURE__*/_jsxs(\"small\",{className:\"d-block text-muted\",children:[\"x\",item.quantity||1]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-end fw-semibold\",style:{justifySelf:'end'},children:formatVND(parseVND(item.price)*(item.quantity||1))})]},item.id))}),/*#__PURE__*/_jsx(\"hr\",{className:\"mt-0\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between mb-2 pt-1\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"font-weight-medium\",children:\"T\\u1ED5ng ph\\u1EE5\"}),/*#__PURE__*/_jsx(\"h6\",{className:\"font-weight-medium\",children:formatVND(getSubtotal())})]}),getBulkDiscount()>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"font-weight-medium mb-0 text-success\",children:\"Gi\\u1EA3m gi\\xE1 mua nhi\\u1EC1u\"}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[\"Mua t\\u1EEB \",promoSettings.bulk_threshold,\" s\\u1EA3n ph\\u1EA9m: -\",promoSettings.bulk_discount,\"%\"]})]}),/*#__PURE__*/_jsxs(\"h6\",{className:\"font-weight-medium text-success\",children:[\"-\",formatVND(getBulkDiscount())]})]}),promoSettings.enable_voucher&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-group input-group-sm\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:`form-control ${voucherError?'is-invalid':''}`,placeholder:\"V\\xED d\\u1EE5: WELCOME20K\",value:voucherCode,onChange:e=>{setVoucherCode(e.target.value);setVoucherError('');setSelectedUserVoucherId(null);},onKeyPress:e=>{if(e.key==='Enter')handleApplyVoucher();}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-primary\",type:\"button\",onClick:handleApplyVoucher,children:\"\\xC1p d\\u1EE5ng\"})]}),voucherError&&/*#__PURE__*/_jsx(\"small\",{className:\"text-danger\",children:voucherError}),voucherDiscount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between mt-2\",children:[/*#__PURE__*/_jsxs(\"small\",{className:\"text-success\",children:[\"Voucher: \",voucherCode]}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-success fw-bold\",children:[\"-\",formatVND(voucherDiscount)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"small\",{className:\"text-muted text-uppercase\",children:\"Voucher c\\u1EE7a b\\u1EA1n\"}),/*#__PURE__*/_jsx(Link,{to:\"/vouchers\",className:\"small text-decoration-none\",children:\"Kho voucher\"})]}),loadingMyVouchers?/*#__PURE__*/_jsx(\"small\",{className:\"text-muted d-block mt-2\",children:\"\\u0110ang t\\u1EA3i voucher \\u0111\\xE3 l\\u01B0u...\"}):/*#__PURE__*/_jsx(_Fragment,{children:availableSavedVouchers.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"d-flex flex-wrap mt-2\",style:{gap:'0.5rem'},children:availableSavedVouchers.map(v=>{const isActive=selectedUserVoucherId===v.user_voucher_id;return/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`btn btn-sm ${isActive?'btn-primary text-white':'btn-outline-primary'}`,onClick:()=>handleSelectSavedVoucher(v),children:[/*#__PURE__*/_jsx(\"div\",{className:\"fw-bold text-uppercase\",children:v.code}),/*#__PURE__*/_jsx(\"small\",{className:`d-block ${isActive?'text-light':'text-muted'}`,children:v.discount_type==='percent'?`-${v.discount_value}%`:`-${formatVND(v.discount_value)}`})]},v.user_voucher_id);})}):/*#__PURE__*/_jsx(\"small\",{className:\"text-muted d-block mt-2\",children:hasAuthToken?'Bạn chưa lưu voucher nào':'Đăng nhập để xem voucher đã lưu'})}),!hasAuthToken&&/*#__PURE__*/_jsxs(\"small\",{className:\"d-block mt-2\",children:[/*#__PURE__*/_jsx(Link,{to:\"/login\",children:\"\\u0110\\u0103ng nh\\u1EADp\"}),\" ho\\u1EB7c \",/*#__PURE__*/_jsx(Link,{to:\"/signup\",children:\"t\\u1EA1o t\\xE0i kho\\u1EA3n\"}),\" \\u0111\\u1EC3 s\\u01B0u t\\u1EA7m voucher.\"]})]})]}),getTotalQuantity()<promoSettings.bulk_threshold&&promoSettings.bulk_discount>0&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info py-2 mb-2\",children:/*#__PURE__*/_jsxs(\"small\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-info-circle me-1\"}),\"Mua th\\xEAm \",promoSettings.bulk_threshold-getTotalQuantity(),\" s\\u1EA3n ph\\u1EA9m \\u0111\\u1EC3 \\u0111\\u01B0\\u1EE3c gi\\u1EA3m \",promoSettings.bulk_discount,\"%\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"font-weight-medium mb-0\",children:\"Ph\\xED v\\u1EADn chuy\\u1EC3n\"}),getSubtotal()-getTotalDiscount()>=shippingSettings.free_threshold?/*#__PURE__*/_jsxs(\"small\",{className:\"text-success\",children:[\"Mi\\u1EC5n ph\\xED (\\u0111\\u01A1n \\u2265 \",formatVND(shippingSettings.free_threshold),\")\"]}):/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[\"Mi\\u1EC5n ph\\xED t\\u1EEB \",formatVND(shippingSettings.free_threshold)]})]}),/*#__PURE__*/_jsx(\"h6\",{className:\"font-weight-medium mb-0\",children:getShippingFee()===0?/*#__PURE__*/_jsx(\"span\",{className:\"text-success\",children:\"Mi\\u1EC5n ph\\xED\"}):formatVND(getShippingFee())})]}),(shippingSettings.delivery_days||shippingSettings.areas)&&/*#__PURE__*/_jsxs(\"div\",{className:\"small text-muted mb-3\",children:[shippingSettings.delivery_days&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-clock me-1\"}),\"D\\u1EF1 ki\\u1EBFn giao h\\xE0ng: \",shippingSettings.delivery_days,\" ng\\xE0y\"]}),shippingSettings.areas&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-map-marker-alt me-1\"}),\"Khu v\\u1EF1c: \",shippingSettings.areas]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-footer bg-transparent border-0 pt-0\",children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mt-2\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"font-weight-bold text-uppercase mb-0\",children:\"T\\u1ED5ng c\\u1ED9ng\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"font-weight-bold text-primary mb-0\",children:formatVND(getTotal())})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card border-secondary mb-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header bg-secondary border-0\",children:/*#__PURE__*/_jsx(\"h4\",{className:\"font-weight-semi-bold m-0\",children:\"Ph\\u01B0\\u01A1ng th\\u1EE9c thanh to\\xE1n\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[paymentSettings.enable_cod&&/*#__PURE__*/_jsx(\"div\",{className:\"form-group mb-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom-control custom-radio\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",className:\"custom-control-input\",name:\"paymentMethod\",id:\"cod\",value:\"cod\",checked:formData.paymentMethod==='cod',onChange:handleInputChange}),/*#__PURE__*/_jsx(\"label\",{className:\"custom-control-label\",htmlFor:\"cod\",children:\"Thanh to\\xE1n khi nh\\u1EADn h\\xE0ng (COD)\"})]})}),paymentSettings.enable_bank&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-group mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"custom-control custom-radio\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",className:\"custom-control-input\",name:\"paymentMethod\",id:\"banktransfer\",value:\"banktransfer\",checked:formData.paymentMethod==='banktransfer',onChange:handleInputChange}),/*#__PURE__*/_jsx(\"label\",{className:\"custom-control-label\",htmlFor:\"banktransfer\",children:\"Chuy\\u1EC3n kho\\u1EA3n ng\\xE2n h\\xE0ng\"})]}),formData.paymentMethod==='banktransfer'&&paymentSettings.bank_info&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 p-3 bg-light rounded border\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"small\",style:{whiteSpace:'pre-line'},children:paymentSettings.bank_info.split('\\n').map((line,idx)=>/*#__PURE__*/_jsx(\"div\",{className:\"mb-1\",children:line},idx))}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 mb-0\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"N\\u1ED9i dung chuy\\u1EC3n kho\\u1EA3n:\"}),\" DH-\",new Date().getFullYear(),\"-\",/*#__PURE__*/_jsx(\"em\",{children:formData.mobile||'SĐT'}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm btn-outline-secondary ms-2\",onClick:()=>{const content=`DH-${new Date().getFullYear()}-${formData.mobile||'SĐT'}`;navigator.clipboard.writeText(content);toast.success('Đã copy nội dung chuyển khoản');},children:\"Copy\"})]})]})]}),paymentSettings.enable_ewallet&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-group mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"custom-control custom-radio\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",className:\"custom-control-input\",name:\"paymentMethod\",id:\"ewallet\",value:\"ewallet\",checked:formData.paymentMethod==='ewallet',onChange:handleInputChange}),/*#__PURE__*/_jsx(\"label\",{className:\"custom-control-label\",htmlFor:\"ewallet\",children:\"V\\xED \\u0111i\\u1EC7n t\\u1EED (Momo, ZaloPay)\"})]}),formData.paymentMethod==='ewallet'&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 p-3 bg-light rounded border\",children:/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Thanh to\\xE1n qua v\\xED \\u0111i\\u1EC7n t\\u1EED s\\u1EBD \\u0111\\u01B0\\u1EE3c x\\u1EED l\\xFD sau khi \\u0111\\u1EB7t h\\xE0ng.\"})})]}),!paymentSettings.enable_cod&&!paymentSettings.enable_bank&&!paymentSettings.enable_ewallet&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-warning\",children:/*#__PURE__*/_jsx(\"small\",{children:\"Hi\\u1EC7n t\\u1EA1i kh\\xF4ng c\\xF3 ph\\u01B0\\u01A1ng th\\u1EE9c thanh to\\xE1n n\\xE0o \\u0111\\u01B0\\u1EE3c k\\xEDch ho\\u1EA1t. Vui l\\xF2ng li\\xEAn h\\u1EC7 admin.\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-footer border-secondary bg-transparent\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-lg btn-block btn-primary font-weight-bold my-3 py-3\",onClick:()=>{if(!formData.paymentMethod){toast.info('Vui lòng chọn phương thức thanh toán');return;}if(!validateForm())return;handlePlaceOrder();},children:\"\\u0110\\u1EB7t h\\xE0ng\"})})]})]})]})}),/*#__PURE__*/_jsx(Footer,{})]});}export default Checkout;","map":{"version":3,"names":["React","Fragment","useEffect","useState","useNavigate","Link","Header","Footer","axios","parseVND","formatVND","toast","jsx","_jsx","jsxs","_jsxs","_Fragment","Checkout","cartItems","setCartItems","formData","setFormData","fullName","mobile","address","state","paymentMethod","note","errors","setErrors","shippingSettings","setShippingSettings","fee","free_threshold","delivery_days","areas","promoSettings","setPromoSettings","bulk_discount","bulk_threshold","enable_voucher","paymentSettings","setPaymentSettings","enable_cod","enable_bank","enable_ewallet","bank_info","voucherCode","setVoucherCode","voucherDiscount","setVoucherDiscount","voucherError","setVoucherError","myVouchers","setMyVouchers","selectedUserVoucherId","setSelectedUserVoucherId","loadingMyVouchers","setLoadingMyVouchers","hasAuthToken","setHasAuthToken","localStorage","getItem","navigate","popularProvinces","otherProvinces","storedCart","JSON","parse","savedMethod","prev","savedForm","parsed","email","get","then","response","data","settings","Object","keys","forEach","key","value","parseInt","catch","error","console","token","headers","Array","isArray","finally","getSubtotal","reduce","total","item","unit","price","quantity","getTotalQuantity","getBulkDiscount","totalQty","subtotal","Math","round","handleApplyVoucher","_ref","codeOverride","arguments","length","undefined","options","candidate","effectiveCode","String","trim","post","code","voucher","min_order_amount","silent","info","discount","discount_type","discount_value","max_discount","userVoucherId","keepSelection","success","_error$response","_error$response$data","message","handleSelectSavedVoucher","is_used","user_voucher_id","getTotalDiscount","availableSavedVouchers","filter","v","getShippingFee","subtotalAfterDiscount","getTotal","handleInputChange","e","name","target","next","setItem","stringify","validateField","msg","includes","phoneOk","test","replace","validateForm","fields","newErrors","f","hasError","some","handlePlaceOrder","_resp$data","orderData","toUpperCase","resp","updatedSold","removeItem","kept","setTimeout","children","className","style","minHeight","href","type","onChange","disabled","label","map","p","rows","to","maxHeight","overflowY","backgroundColor","display","gridTemplateColumns","alignItems","width","whiteSpace","textAlign","title","justifySelf","id","placeholder","onKeyPress","onClick","gap","isActive","checked","htmlFor","split","line","idx","Date","getFullYear","content","navigator","clipboard","writeText"],"sources":["C:/Trần Minh Quý/Chuyên đề Nodejs và React/2200008995_TranMinhQuy/2200008995_TranMinhQuy/ProjectReactNodejs/SHOPBANSACH/frontend/src/pages/Checkout.js"],"sourcesContent":["import React, { Fragment, useEffect, useState } from \"react\";\nimport { useNavigate, Link } from 'react-router-dom';\nimport Header from \"./Header\";\nimport Footer from \"./Footer\";\nimport axios from 'axios';\nimport { parseVND, formatVND } from '../utils/currency';\nimport { toast } from 'react-toastify';\n\nfunction Checkout() {\n    // Khai báo các biến trạng thái\n    const [cartItems, setCartItems] = useState([]); // Danh sách sản phẩm trong giỏ hàng\n    const [formData, setFormData] = useState({\n        fullName: '', // Họ và tên\n        mobile: '', // Số điện thoại\n        address: '', // Địa chỉ\n        state: '', // Tỉnh/Thành phố\n        paymentMethod: '', // Phương thức thanh toán\n        note: '' // Ghi chú (tùy chọn)\n    });\n    const [errors, setErrors] = useState({});\n    const [shippingSettings, setShippingSettings] = useState({\n        fee: 30000,\n        free_threshold: 500000,\n        delivery_days: 3,\n        areas: 'Toàn quốc'\n    });\n    const [promoSettings, setPromoSettings] = useState({\n        bulk_discount: 0,\n        bulk_threshold: 5,\n        enable_voucher: false\n    });\n    const [paymentSettings, setPaymentSettings] = useState({\n        enable_cod: true,\n        enable_bank: false,\n        enable_ewallet: false,\n        bank_info: ''\n    });\n    const [voucherCode, setVoucherCode] = useState('');\n    const [voucherDiscount, setVoucherDiscount] = useState(0);\n    const [voucherError, setVoucherError] = useState('');\n    const [myVouchers, setMyVouchers] = useState([]);\n    const [selectedUserVoucherId, setSelectedUserVoucherId] = useState(null);\n    const [loadingMyVouchers, setLoadingMyVouchers] = useState(false);\n    const [hasAuthToken, setHasAuthToken] = useState(!!localStorage.getItem('token'));\n    const navigate = useNavigate();\n\n    const popularProvinces = [\n        'Hồ Chí Minh','Hà Nội','Đà Nẵng','Cần Thơ','Bình Dương','Đồng Nai','Hải Phòng'\n    ];\n    const otherProvinces = [\n        'An Giang','Bà Rịa - Vũng Tàu','Bắc Giang','Bắc Kạn','Bạc Liêu','Bắc Ninh','Bến Tre','Bình Định','Bình Phước','Bình Thuận','Cà Mau','Cao Bằng','Đắk Lắk','Đắk Nông','Điện Biên','Đồng Tháp','Gia Lai','Hà Giang','Hà Nam','Hà Tĩnh','Hải Dương','Hậu Giang','Hòa Bình','Hưng Yên','Khánh Hòa','Kiên Giang','Kon Tum','Lai Châu','Lâm Đồng','Lạng Sơn','Lào Cai','Long An','Nam Định','Nghệ An','Ninh Bình','Ninh Thuận','Phú Thọ','Phú Yên','Quảng Bình','Quảng Nam','Quảng Ngãi','Quảng Ninh','Quảng Trị','Sóc Trăng','Sơn La','Tây Ninh','Thái Bình','Thái Nguyên','Thanh Hóa','Thừa Thiên Huế','Tiền Giang','Trà Vinh','Tuyên Quang','Vĩnh Long','Vĩnh Phúc','Yên Bái'\n    ];\n\n    // Sử dụng useEffect để lấy giỏ hàng từ localStorage \n    useEffect(() => {\n        const storedCart = localStorage.getItem(\"cart\");\n        if (storedCart) {\n            setCartItems(JSON.parse(storedCart));\n        }\n        // Khôi phục phương thức thanh toán\n        const savedMethod = localStorage.getItem('paymentMethod');\n        if (savedMethod) {\n            setFormData((prev) => ({...prev, paymentMethod: savedMethod}));\n        } else {\n            // default chọn COD nếu được bật, nếu không thì chọn phương thức đầu tiên có sẵn\n            // Sẽ được set sau khi load settings\n        }\n\n        // Khôi phục dữ liệu form\n        const savedForm = localStorage.getItem('checkoutForm');\n        if (savedForm) {\n            try {\n                const parsed = JSON.parse(savedForm);\n                // Ignore any legacy `email` stored previously\n                if (parsed && parsed.email) delete parsed.email;\n                setFormData((prev) => ({...prev, ...parsed}));\n            } catch {}\n        }\n\n        // Fetch settings\n        axios.get('/api/settings')\n            .then(response => {\n                if (response.data && typeof response.data === 'object') {\n                    const settings = {};\n                    Object.keys(response.data).forEach(key => {\n                        settings[key] = response.data[key].value || '';\n                    });\n                    setShippingSettings({\n                        fee: parseInt(settings['shipping.fee']) || 30000,\n                        free_threshold: parseInt(settings['shipping.free_threshold']) || 500000,\n                        delivery_days: parseInt(settings['shipping.delivery_days']) || 3,\n                        areas: settings['shipping.areas'] || 'Toàn quốc'\n                    });\n                    setPromoSettings({\n                        bulk_discount: parseInt(settings['promo.bulk_discount']) || 0,\n                        bulk_threshold: parseInt(settings['promo.bulk_threshold']) || 5,\n                        enable_voucher: settings['promo.enable_voucher'] === 'true'\n                    });\n                    const paymentSettings = {\n                        enable_cod: settings['payment.enable_cod'] === 'true',\n                        enable_bank: settings['payment.enable_bank'] === 'true',\n                        enable_ewallet: settings['payment.enable_ewallet'] === 'true',\n                        bank_info: settings['payment.bank_info'] || ''\n                    };\n                    setPaymentSettings(paymentSettings);\n                    \n                    // Set default payment method if not set\n                    if (!formData.paymentMethod) {\n                        if (paymentSettings.enable_cod) {\n                            setFormData((prev) => ({...prev, paymentMethod: 'cod'}));\n                        } else if (paymentSettings.enable_bank) {\n                            setFormData((prev) => ({...prev, paymentMethod: 'banktransfer'}));\n                        } else if (paymentSettings.enable_ewallet) {\n                            setFormData((prev) => ({...prev, paymentMethod: 'ewallet'}));\n                        }\n                    }\n                }\n            })\n            .catch(error => {\n                console.error('Error fetching settings:', error);\n            });\n\n        const token = localStorage.getItem('token');\n        setHasAuthToken(!!token);\n        if (token) {\n            setLoadingMyVouchers(true);\n            axios.get('/api/my-vouchers', { headers: { 'Authorization': `Bearer ${token}` } })\n                .then(response => {\n                    setMyVouchers(Array.isArray(response.data) ? response.data : []);\n                })\n                .catch(error => {\n                    console.error('Error fetching my vouchers:', error);\n                })\n                .finally(() => setLoadingMyVouchers(false));\n        }\n    }, []);\n\n    // Hàm tính tổng phụ (subtotal) của giỏ hàng - chuẩn hoá giá VND\n    const getSubtotal = () => {\n        return cartItems.reduce((total, item) => {\n            const unit = parseVND(item.price);\n            return total + unit * (item.quantity || 1);\n        }, 0);\n    };\n\n    // Tính tổng số lượng sản phẩm\n    const getTotalQuantity = () => {\n        return cartItems.reduce((total, item) => total + (item.quantity || 1), 0);\n    };\n\n    // Tính giảm giá khi mua nhiều\n    const getBulkDiscount = () => {\n        const totalQty = getTotalQuantity();\n        if (totalQty >= promoSettings.bulk_threshold && promoSettings.bulk_discount > 0) {\n            const subtotal = getSubtotal();\n            return Math.round(subtotal * promoSettings.bulk_discount / 100);\n        }\n        return 0;\n    };\n\n    // Xử lý áp dụng voucher\n    const handleApplyVoucher = async (codeOverride = null, options = {}) => {\n        const candidate = codeOverride ?? voucherCode ?? '';\n        const effectiveCode = String(candidate).trim();\n        if (!effectiveCode) {\n            setVoucherError('Vui lòng nhập mã voucher');\n            return;\n        }\n        \n        try {\n            const response = await axios.post('/api/vouchers/validate', { code: effectiveCode });\n            const voucher = response.data;\n            const subtotal = getSubtotal() - getBulkDiscount();\n            \n            // Check minimum order amount\n            if (subtotal < voucher.min_order_amount) {\n                setVoucherError(`Đơn hàng tối thiểu ${formatVND(voucher.min_order_amount)} để sử dụng voucher này`);\n                setVoucherDiscount(0);\n                if (!options.silent) toast.info('Giá trị đơn hàng chưa đạt điều kiện voucher');\n                return;\n            }\n            \n            // Calculate discount\n            let discount = 0;\n            if (voucher.discount_type === 'percent') {\n                discount = Math.round(subtotal * voucher.discount_value / 100);\n                if (voucher.max_discount && discount > voucher.max_discount) {\n                    discount = voucher.max_discount;\n                }\n            } else {\n                discount = voucher.discount_value;\n            }\n            \n            setVoucherDiscount(discount);\n            setVoucherError('');\n            setVoucherCode(effectiveCode);\n            if (options.userVoucherId) {\n                setSelectedUserVoucherId(options.userVoucherId);\n            } else if (!options.keepSelection) {\n                setSelectedUserVoucherId(null);\n            }\n            if (!options.silent) toast.success('Áp dụng voucher thành công!');\n        } catch (error) {\n            setVoucherError(error.response?.data?.message || 'Mã voucher không hợp lệ');\n            setVoucherDiscount(0);\n            if (!options.silent) toast.error('Áp dụng voucher thất bại');\n        }\n    };\n\n    const handleSelectSavedVoucher = (voucher) => {\n        if (!voucher || voucher.is_used) {\n            toast.info('Voucher đã được sử dụng');\n            return;\n        }\n        handleApplyVoucher(voucher.code, { userVoucherId: voucher.user_voucher_id, keepSelection: true });\n    };\n\n    // Tính tổng giảm giá (bulk + voucher)\n    const getTotalDiscount = () => {\n        return getBulkDiscount() + voucherDiscount;\n    };\n\n    const availableSavedVouchers = myVouchers.filter(v => !v.is_used);\n\n    // Hàm tính phí vận chuyển (tính sau khi trừ giảm giá)\n    const getShippingFee = () => {\n        const subtotalAfterDiscount = getSubtotal() - getTotalDiscount();\n        if (subtotalAfterDiscount >= shippingSettings.free_threshold) {\n            return 0; // Miễn phí ship\n        }\n        return shippingSettings.fee || 0;\n    };\n\n    // Hàm tính tổng cộng (total) của giỏ hàng\n    const getTotal = () => {\n        return getSubtotal() - getTotalDiscount() + getShippingFee();\n    };\n\n    // Hàm xử lý thay đổi dữ liệu trong form\n    const handleInputChange = (e) => {\n        const { name, value } = e.target;\n        const next = { ...formData, [name]: value };\n        setFormData(next);\n        // Lưu localStorage\n        if (name === 'paymentMethod') localStorage.setItem('paymentMethod', value);\n        localStorage.setItem('checkoutForm', JSON.stringify({\n            fullName: next.fullName,\n            mobile: next.mobile,\n            address: next.address,\n            state: next.state,\n            note: next.note\n        }));\n        // Validate nhanh từng trường\n        validateField(name, value);\n    };\n\n    const validateField = (name, value) => {\n        let msg = '';\n        if (['fullName','mobile','address','state'].includes(name) && !value.trim()) msg = 'Vui lòng nhập thông tin.';\n        if (name === 'mobile') {\n            const phoneOk = /^(0[3|5|7|8|9])[0-9]{8}$/.test(value.replace(/\\s+/g,''));\n            if (!phoneOk) msg = 'Số điện thoại VN không hợp lệ.';\n        }\n        setErrors(prev => ({...prev, [name]: msg}));\n    };\n\n    const validateForm = () => {\n        const fields = ['fullName','mobile','address','state'];\n        const newErrors = {};\n        fields.forEach(f => validateField(f, formData[f]));\n        fields.forEach(f => {\n            if (!formData[f] || (errors[f] && errors[f].length)) newErrors[f] = errors[f] || 'Vui lòng nhập thông tin.';\n        });\n        setErrors(prev => ({...prev, ...newErrors}));\n        const hasError = fields.some(f => newErrors[f]);\n        return !hasError;\n    };\n\n    // Hàm xử lý đặt hàng\n    const handlePlaceOrder = async () => {\n        // Kiểm tra nếu giỏ hàng trống\n        if (cartItems.length === 0) {\n            toast.info('Giỏ hàng trống. Vui lòng thêm sản phẩm trước khi thanh toán.');\n            return;\n        }\n\n        // Validate form giao hàng\n        if (!validateForm()) {\n            toast.info('Vui lòng kiểm tra lại thông tin giao hàng.');\n            return;\n        }\n\n        try {\n            // Tạo dữ liệu đơn hàng\n            const orderData = {\n                // Do not send email field anymore\n                fullName: formData.fullName,\n                mobile: formData.mobile,\n                address: formData.address,\n                state: formData.state,\n                paymentMethod: formData.paymentMethod,\n                note: formData.note,\n                cartItems,\n                total: getTotal(),\n                voucherCode: voucherCode ? voucherCode.trim().toUpperCase() : null,\n                userVoucherId: selectedUserVoucherId\n            };\n\n            // Gửi dữ liệu đơn hàng lên server\n            const token = localStorage.getItem('token');\n            const headers = token ? { 'Authorization': `Bearer ${token}` } : {};\n            const resp = await axios.post('/api/orders', orderData, { headers });\n            const updatedSold = resp?.data?.updatedSold;\n            toast.success(`Đặt hàng thành công!${typeof updatedSold === 'number' ? ` (cập nhật ${updatedSold} sản phẩm)` : ''}`);\n            localStorage.removeItem('cart'); // Xóa giỏ hàng sau khi đặt hàng thành công\n            // Giữ lại thông tin người nhận cho lần sau, chỉ xóa ghi chú\n            const kept = {...formData, note: ''};\n            localStorage.setItem('checkoutForm', JSON.stringify({\n                fullName: kept.fullName,\n                mobile: kept.mobile,\n                address: kept.address,\n                state: kept.state,\n                note: kept.note\n            }));\n            // Điều hướng về trang Cửa hàng để refetch dữ liệu và thấy \"Đã bán\" cập nhật\n            setTimeout(() => navigate('/shop'), 300);\n        } catch (error) {\n            console.error('Error placing order:', error);\n            toast.error('Có lỗi xảy ra khi đặt hàng. Vui lòng thử lại.');\n        }\n    };\n\n    return (\n        <Fragment>\n            <Header />\n\n            <div className=\"container-fluid bg-secondary mb-5\">\n                <div className=\"d-flex flex-column align-items-center justify-content-center\" style={{ minHeight: '300px' }}>\n                    <h1 className=\"font-weight-semi-bold text-uppercase mb-3\">Thanh toán</h1>\n                    <div className=\"d-inline-flex\">\n                        <p className=\"m-0\"><a href=\"/\">Trang chủ</a></p>\n                        <p className=\"m-0 px-2\">-</p>\n                        <p className=\"m-0\">Thanh toán</p>\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"container-fluid pt-5\">\n                <div className=\"row px-xl-5\">\n                    <div className=\"col-lg-8\">\n                        <div className=\"mb-4\">\n                            <h4 className=\"font-weight-semi-bold mb-4\">Thông tin giao hàng</h4>\n                            <div className=\"row\">\n                                <div className=\"col-md-6 form-group\">\n                                    <label>Họ và tên</label>\n                                    <input className=\"form-control\" type=\"text\" name=\"fullName\" value={formData.fullName} onChange={handleInputChange} />\n                                    {errors.fullName && <small className=\"text-danger\">{errors.fullName}</small>}\n                                </div>\n                                {/* Email field removed: we no longer collect a separate shipping email */}\n                                <div className=\"col-md-6 form-group\">\n                                    <label>Số điện thoại</label>\n                                    <input className=\"form-control\" type=\"text\" name=\"mobile\" value={formData.mobile} onChange={handleInputChange} />\n                                    {errors.mobile && <small className=\"text-danger\">{errors.mobile}</small>}\n                                </div>\n                                <div className=\"col-md-6 form-group\">\n                                    <label>Địa chỉ</label>\n                                    <input className=\"form-control\" type=\"text\" name=\"address\" value={formData.address} onChange={handleInputChange} />\n                                    {errors.address && <small className=\"text-danger\">{errors.address}</small>}\n                                </div>\n                                <div className=\"col-md-6 form-group\">\n                                    <label>Tỉnh/Thành <span className=\"text-danger\">*</span></label>\n                                    <select className=\"form-control\" name=\"state\" value={formData.state} onChange={handleInputChange}>\n                                        <option value=\"\" disabled>Chọn Tỉnh/Thành nơi nhận hàng</option>\n                                        <optgroup label=\"Phổ biến\">\n                                            {popularProvinces.map(p => (\n                                                <option key={p} value={p}>{p}</option>\n                                            ))}\n                                        </optgroup>\n                                        <optgroup label=\"Khác\">\n                                            {otherProvinces.map(p => (\n                                                <option key={p} value={p}>{p}</option>\n                                            ))}\n                                        </optgroup>\n                                    </select>\n                                    <small className=\"text-muted\">Chọn tỉnh/thành để đảm bảo giao đúng khu vực.</small><br/>\n                                    {errors.state && <small className=\"text-danger\">{errors.state}</small>}\n                                </div>\n                                <div className=\"col-md-6 form-group\">\n                                    <label>Ghi chú (tùy chọn)</label>\n                                    <textarea className=\"form-control\" rows=\"1\" name=\"note\" value={formData.note} onChange={handleInputChange}></textarea>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"col-lg-4\">\n                        <div className=\"card border-0 shadow-sm mb-4\">\n                            <div className=\"card-header bg-light border-0 text-center\">\n                                <h4 className=\"font-weight-semi-bold m-0 text-uppercase\">Tổng đơn hàng</h4>\n                            </div>\n                            <div className=\"card-body\">\n                                <div className=\"d-flex justify-content-between align-items-center mb-3\">\n                                    <h6 className=\"text-uppercase text-muted mb-0\">Sản phẩm</h6>\n                                    <Link to=\"/cart\" className=\"small text-decoration-none\">Chỉnh sửa giỏ hàng</Link>\n                                </div>\n                                <div className=\"order-items-list border rounded p-3 mb-3\" style={{maxHeight:'240px', overflowY:'auto', backgroundColor:'#fdfdfd'}}>\n                                    {cartItems.map((item) => (\n                                        <div\n                                            key={item.id}\n                                            className=\"py-1\"\n                                            style={{\n                                                display: 'grid',\n                                                gridTemplateColumns: '1fr auto',\n                                                alignItems: 'center',\n                                                width: '100%'\n                                            }}\n                                        >\n                                            <div className=\"text-truncate\" style={{whiteSpace:'nowrap', textAlign:'left'}} title={item.name}>\n                                                <span className=\"fw-semibold\">{item.name}</span>\n                                                <small className=\"d-block text-muted\">x{item.quantity || 1}</small>\n                                            </div>\n                                            <span className=\"text-end fw-semibold\" style={{justifySelf:'end'}}>{formatVND(parseVND(item.price) * (item.quantity || 1))}</span>\n                                        </div>\n                                    ))}\n                                </div>\n                                <hr className=\"mt-0\" />\n                                <div className=\"d-flex justify-content-between mb-2 pt-1\">\n                                    <h6 className=\"font-weight-medium\">Tổng phụ</h6>\n                                    <h6 className=\"font-weight-medium\">{formatVND(getSubtotal())}</h6>\n                                </div>\n                                {getBulkDiscount() > 0 && (\n                                    <div className=\"d-flex justify-content-between mb-2\">\n                                        <div>\n                                            <h6 className=\"font-weight-medium mb-0 text-success\">Giảm giá mua nhiều</h6>\n                                            <small className=\"text-muted\">Mua từ {promoSettings.bulk_threshold} sản phẩm: -{promoSettings.bulk_discount}%</small>\n                                        </div>\n                                        <h6 className=\"font-weight-medium text-success\">-{formatVND(getBulkDiscount())}</h6>\n                                    </div>\n                                )}\n                                {promoSettings.enable_voucher && (\n                                    <div className=\"mb-2\">\n                                        <div className=\"input-group input-group-sm\">\n                                            <input \n                                                type=\"text\" \n                                            className={`form-control ${voucherError ? 'is-invalid' : ''}`}\n                                            placeholder=\"Ví dụ: WELCOME20K\"\n                                                value={voucherCode}\n                                                onChange={(e) => {\n                                                    setVoucherCode(e.target.value);\n                                                    setVoucherError('');\n                                                    setSelectedUserVoucherId(null);\n                                                }}\n                                                onKeyPress={(e) => {\n                                                    if (e.key === 'Enter') handleApplyVoucher();\n                                                }}\n                                            />\n                                            <button \n                                                className=\"btn btn-outline-primary\" \n                                                type=\"button\"\n                                                onClick={handleApplyVoucher}\n                                            >\n                                                Áp dụng\n                                            </button>\n                                        </div>\n                                        {voucherError && <small className=\"text-danger\">{voucherError}</small>}\n                                        {voucherDiscount > 0 && (\n                                            <div className=\"d-flex justify-content-between mt-2\">\n                                                <small className=\"text-success\">Voucher: {voucherCode}</small>\n                                                <small className=\"text-success fw-bold\">-{formatVND(voucherDiscount)}</small>\n                                            </div>\n                                        )}\n                                        <div className=\"mt-3\">\n                                            <div className=\"d-flex justify-content-between align-items-center\">\n                                                <small className=\"text-muted text-uppercase\">Voucher của bạn</small>\n                                                <Link to=\"/vouchers\" className=\"small text-decoration-none\">Kho voucher</Link>\n                                            </div>\n                                            {loadingMyVouchers ? (\n                                                <small className=\"text-muted d-block mt-2\">Đang tải voucher đã lưu...</small>\n                                            ) : (\n                                                <>\n                                                    {availableSavedVouchers.length > 0 ? (\n                                                        <div className=\"d-flex flex-wrap mt-2\" style={{ gap: '0.5rem' }}>\n                                                            {availableSavedVouchers.map(v => {\n                                                                const isActive = selectedUserVoucherId === v.user_voucher_id;\n                                                                return (\n                                                                <button\n                                                                    type=\"button\"\n                                                                    key={v.user_voucher_id}\n                                                                    className={`btn btn-sm ${isActive ? 'btn-primary text-white' : 'btn-outline-primary'}`}\n                                                                    onClick={() => handleSelectSavedVoucher(v)}\n                                                                >\n                                                                    <div className=\"fw-bold text-uppercase\">{v.code}</div>\n                                                                    <small className={`d-block ${isActive ? 'text-light' : 'text-muted'}`}>\n                                                                        {v.discount_type === 'percent' ? `-${v.discount_value}%` : `-${formatVND(v.discount_value)}`}\n                                                                    </small>\n                                                                </button>\n                                                            );})}\n                                                        </div>\n                                                    ) : (\n                                                        <small className=\"text-muted d-block mt-2\">\n                                                            {hasAuthToken ? 'Bạn chưa lưu voucher nào' : 'Đăng nhập để xem voucher đã lưu'}\n                                                        </small>\n                                                    )}\n                                                </>\n                                            )}\n                                            {!hasAuthToken && (\n                                                <small className=\"d-block mt-2\">\n                                                    <Link to=\"/login\">Đăng nhập</Link> hoặc <Link to=\"/signup\">tạo tài khoản</Link> để sưu tầm voucher.\n                                                </small>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n                                {getTotalQuantity() < promoSettings.bulk_threshold && promoSettings.bulk_discount > 0 && (\n                                    <div className=\"alert alert-info py-2 mb-2\">\n                                        <small>\n                                            <i className=\"fa fa-info-circle me-1\"></i>\n                                            Mua thêm {promoSettings.bulk_threshold - getTotalQuantity()} sản phẩm để được giảm {promoSettings.bulk_discount}%\n                                        </small>\n                                    </div>\n                                )}\n                                <div className=\"d-flex justify-content-between align-items-center mb-3\">\n                                    <div>\n                                        <h6 className=\"font-weight-medium mb-0\">Phí vận chuyển</h6>\n                                        {(getSubtotal() - getTotalDiscount()) >= shippingSettings.free_threshold ? (\n                                            <small className=\"text-success\">Miễn phí (đơn ≥ {formatVND(shippingSettings.free_threshold)})</small>\n                                        ) : (\n                                            <small className=\"text-muted\">Miễn phí từ {formatVND(shippingSettings.free_threshold)}</small>\n                                        )}\n                                    </div>\n                                    <h6 className=\"font-weight-medium mb-0\">\n                                        {getShippingFee() === 0 ? (\n                                            <span className=\"text-success\">Miễn phí</span>\n                                        ) : (\n                                            formatVND(getShippingFee())\n                                        )}\n                                    </h6>\n                                </div>\n                                {(shippingSettings.delivery_days || shippingSettings.areas) && (\n                                    <div className=\"small text-muted mb-3\">\n                                        {shippingSettings.delivery_days && (\n                                            <div><i className=\"fa fa-clock me-1\"></i>Dự kiến giao hàng: {shippingSettings.delivery_days} ngày</div>\n                                        )}\n                                        {shippingSettings.areas && (\n                                            <div><i className=\"fa fa-map-marker-alt me-1\"></i>Khu vực: {shippingSettings.areas}</div>\n                                        )}\n                                    </div>\n                                )}\n                            </div>\n                            <div className=\"card-footer bg-transparent border-0 pt-0\">\n                                <hr />\n                                <div className=\"d-flex justify-content-between align-items-center mt-2\">\n                                    <h5 className=\"font-weight-bold text-uppercase mb-0\">Tổng cộng</h5>\n                                    <h4 className=\"font-weight-bold text-primary mb-0\">{formatVND(getTotal())}</h4>\n                                </div>\n                            </div>\n                        </div>\n                        {/* Các lựa chọn phương thức thanh toán */}\n                        <div className=\"card border-secondary mb-5\">\n                            <div className=\"card-header bg-secondary border-0\">\n                                <h4 className=\"font-weight-semi-bold m-0\">Phương thức thanh toán</h4>\n                            </div>\n                            <div className=\"card-body\">\n                                {paymentSettings.enable_cod && (\n                                    <div className=\"form-group mb-2\">\n                                        <div className=\"custom-control custom-radio\">\n                                            <input\n                                                type=\"radio\"\n                                                className=\"custom-control-input\"\n                                                name=\"paymentMethod\"\n                                                id=\"cod\"\n                                                value=\"cod\"\n                                                checked={formData.paymentMethod === 'cod'}\n                                                onChange={handleInputChange}\n                                            />\n                                            <label className=\"custom-control-label\" htmlFor=\"cod\">Thanh toán khi nhận hàng (COD)</label>\n                                        </div>\n                                    </div>\n                                )}\n                                {paymentSettings.enable_bank && (\n                                    <div className=\"form-group mb-2\">\n                                        <div className=\"custom-control custom-radio\">\n                                            <input\n                                                type=\"radio\"\n                                                className=\"custom-control-input\"\n                                                name=\"paymentMethod\"\n                                                id=\"banktransfer\"\n                                                value=\"banktransfer\"\n                                                checked={formData.paymentMethod === 'banktransfer'}\n                                                onChange={handleInputChange}\n                                            />\n                                            <label className=\"custom-control-label\" htmlFor=\"banktransfer\">Chuyển khoản ngân hàng</label>\n                                        </div>\n                                        {formData.paymentMethod === 'banktransfer' && paymentSettings.bank_info && (\n                                            <div className=\"mt-3 p-3 bg-light rounded border\">\n                                                <div className=\"small\" style={{ whiteSpace: 'pre-line' }}>\n                                                    {paymentSettings.bank_info.split('\\n').map((line, idx) => (\n                                                        <div key={idx} className=\"mb-1\">{line}</div>\n                                                    ))}\n                                                </div>\n                                                <div className=\"mt-2 mb-0\">\n                                                    <strong>Nội dung chuyển khoản:</strong> DH-{new Date().getFullYear()}-<em>{formData.mobile || 'SĐT'}</em>\n                                                    <button\n                                                        className=\"btn btn-sm btn-outline-secondary ms-2\"\n                                                        onClick={() => {\n                                                            const content = `DH-${new Date().getFullYear()}-${formData.mobile || 'SĐT'}`;\n                                                            navigator.clipboard.writeText(content);\n                                                            toast.success('Đã copy nội dung chuyển khoản');\n                                                        }}>Copy</button>\n                                                </div>\n                                            </div>\n                                        )}\n                                    </div>\n                                )}\n                                {paymentSettings.enable_ewallet && (\n                                    <div className=\"form-group mb-2\">\n                                        <div className=\"custom-control custom-radio\">\n                                            <input\n                                                type=\"radio\"\n                                                className=\"custom-control-input\"\n                                                name=\"paymentMethod\"\n                                                id=\"ewallet\"\n                                                value=\"ewallet\"\n                                                checked={formData.paymentMethod === 'ewallet'}\n                                                onChange={handleInputChange}\n                                            />\n                                            <label className=\"custom-control-label\" htmlFor=\"ewallet\">Ví điện tử (Momo, ZaloPay)</label>\n                                        </div>\n                                        {formData.paymentMethod === 'ewallet' && (\n                                            <div className=\"mt-3 p-3 bg-light rounded border\">\n                                                <small className=\"text-muted\">Thanh toán qua ví điện tử sẽ được xử lý sau khi đặt hàng.</small>\n                                            </div>\n                                        )}\n                                    </div>\n                                )}\n                                {!paymentSettings.enable_cod && !paymentSettings.enable_bank && !paymentSettings.enable_ewallet && (\n                                    <div className=\"alert alert-warning\">\n                                        <small>Hiện tại không có phương thức thanh toán nào được kích hoạt. Vui lòng liên hệ admin.</small>\n                                    </div>\n                                )}\n                            </div>\n                            <div className=\"card-footer border-secondary bg-transparent\">\n                                <button\n                                    className=\"btn btn-lg btn-block btn-primary font-weight-bold my-3 py-3\"\n                                    onClick={() => {\n                                        if (!formData.paymentMethod) {\n                                            toast.info('Vui lòng chọn phương thức thanh toán');\n                                            return;\n                                        }\n                                        if (!validateForm()) return;\n                                        handlePlaceOrder();\n                                    }}>Đặt hàng\n                                </button>\n                            </div>\n                        </div>\n\n                    </div>\n                </div>\n            </div>\n\n            <Footer />\n        </Fragment>\n    );\n}\n\nexport default Checkout;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}