{"ast":null,"code":"var _jsxFileName = \"C:\\\\Tr\\u1EA7n Minh Qu\\xFD\\\\Chuy\\xEAn \\u0111\\u1EC1 Nodejs v\\xE0 React\\\\2200008995_TranMinhQuy\\\\2200008995_TranMinhQuy\\\\ProjectReactNodejs\\\\SHOPBANSACH\\\\frontend\\\\src\\\\pages\\\\Checkout.js\",\n  _s = $RefreshSig$();\nimport React, { Fragment, useEffect, useState } from \"react\";\nimport { useNavigate, Link } from 'react-router-dom';\nimport Header from \"./Header\";\nimport Footer from \"./Footer\";\nimport axios from 'axios';\nimport { parseVND, formatVND } from '../utils/currency';\nimport { toast } from 'react-toastify';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction Checkout() {\n  _s();\n  // Khai báo các biến trạng thái\n  const [cartItems, setCartItems] = useState([]); // Danh sách sản phẩm trong giỏ hàng\n  const [formData, setFormData] = useState({\n    fullName: '',\n    // Họ và tên\n    mobile: '',\n    // Số điện thoại\n    address: '',\n    // Địa chỉ\n    state: '',\n    // Tỉnh/Thành phố\n    paymentMethod: '',\n    // Phương thức thanh toán\n    note: '' // Ghi chú (tùy chọn)\n  });\n  const [errors, setErrors] = useState({});\n  const [shippingSettings, setShippingSettings] = useState({\n    fee: 30000,\n    free_threshold: 500000,\n    delivery_days: 3,\n    areas: 'Toàn quốc'\n  });\n  const [promoSettings, setPromoSettings] = useState({\n    bulk_discount: 0,\n    bulk_threshold: 5,\n    enable_voucher: false\n  });\n  const [paymentSettings, setPaymentSettings] = useState({\n    enable_cod: true,\n    enable_bank: false,\n    enable_ewallet: false,\n    bank_info: ''\n  });\n  const [voucherCode, setVoucherCode] = useState('');\n  const [voucherDiscount, setVoucherDiscount] = useState(0);\n  const [voucherError, setVoucherError] = useState('');\n  const [myVouchers, setMyVouchers] = useState([]);\n  const [selectedUserVoucherId, setSelectedUserVoucherId] = useState(null);\n  const [loadingMyVouchers, setLoadingMyVouchers] = useState(false);\n  const [hasAuthToken, setHasAuthToken] = useState(!!localStorage.getItem('token'));\n  const navigate = useNavigate();\n  const popularProvinces = ['Hồ Chí Minh', 'Hà Nội', 'Đà Nẵng', 'Cần Thơ', 'Bình Dương', 'Đồng Nai', 'Hải Phòng'];\n  const otherProvinces = ['An Giang', 'Bà Rịa - Vũng Tàu', 'Bắc Giang', 'Bắc Kạn', 'Bạc Liêu', 'Bắc Ninh', 'Bến Tre', 'Bình Định', 'Bình Phước', 'Bình Thuận', 'Cà Mau', 'Cao Bằng', 'Đắk Lắk', 'Đắk Nông', 'Điện Biên', 'Đồng Tháp', 'Gia Lai', 'Hà Giang', 'Hà Nam', 'Hà Tĩnh', 'Hải Dương', 'Hậu Giang', 'Hòa Bình', 'Hưng Yên', 'Khánh Hòa', 'Kiên Giang', 'Kon Tum', 'Lai Châu', 'Lâm Đồng', 'Lạng Sơn', 'Lào Cai', 'Long An', 'Nam Định', 'Nghệ An', 'Ninh Bình', 'Ninh Thuận', 'Phú Thọ', 'Phú Yên', 'Quảng Bình', 'Quảng Nam', 'Quảng Ngãi', 'Quảng Ninh', 'Quảng Trị', 'Sóc Trăng', 'Sơn La', 'Tây Ninh', 'Thái Bình', 'Thái Nguyên', 'Thanh Hóa', 'Thừa Thiên Huế', 'Tiền Giang', 'Trà Vinh', 'Tuyên Quang', 'Vĩnh Long', 'Vĩnh Phúc', 'Yên Bái'];\n\n  // Sử dụng useEffect để lấy giỏ hàng từ localStorage \n  useEffect(() => {\n    const storedCart = localStorage.getItem(\"cart\");\n    if (storedCart) {\n      setCartItems(JSON.parse(storedCart));\n    }\n    // Khôi phục phương thức thanh toán\n    const savedMethod = localStorage.getItem('paymentMethod');\n    if (savedMethod) {\n      setFormData(prev => ({\n        ...prev,\n        paymentMethod: savedMethod\n      }));\n    } else {\n      // default chọn COD nếu được bật, nếu không thì chọn phương thức đầu tiên có sẵn\n      // Sẽ được set sau khi load settings\n    }\n\n    // Khôi phục dữ liệu form\n    const savedForm = localStorage.getItem('checkoutForm');\n    if (savedForm) {\n      try {\n        const parsed = JSON.parse(savedForm);\n        // Ignore any legacy `email` stored previously\n        if (parsed && parsed.email) delete parsed.email;\n        setFormData(prev => ({\n          ...prev,\n          ...parsed\n        }));\n      } catch {}\n    }\n\n    // Fetch settings\n    axios.get('/api/settings').then(response => {\n      if (response.data && typeof response.data === 'object') {\n        const settings = {};\n        Object.keys(response.data).forEach(key => {\n          settings[key] = response.data[key].value || '';\n        });\n        setShippingSettings({\n          fee: parseInt(settings['shipping.fee']) || 30000,\n          free_threshold: parseInt(settings['shipping.free_threshold']) || 500000,\n          delivery_days: parseInt(settings['shipping.delivery_days']) || 3,\n          areas: settings['shipping.areas'] || 'Toàn quốc'\n        });\n        setPromoSettings({\n          bulk_discount: parseInt(settings['promo.bulk_discount']) || 0,\n          bulk_threshold: parseInt(settings['promo.bulk_threshold']) || 5,\n          enable_voucher: settings['promo.enable_voucher'] === 'true'\n        });\n        const paymentSettings = {\n          enable_cod: settings['payment.enable_cod'] === 'true',\n          enable_bank: settings['payment.enable_bank'] === 'true',\n          enable_ewallet: settings['payment.enable_ewallet'] === 'true',\n          bank_info: settings['payment.bank_info'] || ''\n        };\n        setPaymentSettings(paymentSettings);\n\n        // Set default payment method if not set\n        if (!formData.paymentMethod) {\n          if (paymentSettings.enable_cod) {\n            setFormData(prev => ({\n              ...prev,\n              paymentMethod: 'cod'\n            }));\n          } else if (paymentSettings.enable_bank) {\n            setFormData(prev => ({\n              ...prev,\n              paymentMethod: 'banktransfer'\n            }));\n          } else if (paymentSettings.enable_ewallet) {\n            setFormData(prev => ({\n              ...prev,\n              paymentMethod: 'ewallet'\n            }));\n          }\n        }\n      }\n    }).catch(error => {\n      console.error('Error fetching settings:', error);\n    });\n    const token = localStorage.getItem('token');\n    setHasAuthToken(!!token);\n    if (token) {\n      setLoadingMyVouchers(true);\n      axios.get('/api/my-vouchers', {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      }).then(response => {\n        setMyVouchers(Array.isArray(response.data) ? response.data : []);\n      }).catch(error => {\n        console.error('Error fetching my vouchers:', error);\n      }).finally(() => setLoadingMyVouchers(false));\n    }\n  }, []);\n\n  // Hàm tính tổng phụ (subtotal) của giỏ hàng - chuẩn hoá giá VND\n  const getSubtotal = () => {\n    return cartItems.reduce((total, item) => {\n      const unit = parseVND(item.price);\n      return total + unit * (item.quantity || 1);\n    }, 0);\n  };\n\n  // Tính tổng số lượng sản phẩm\n  const getTotalQuantity = () => {\n    return cartItems.reduce((total, item) => total + (item.quantity || 1), 0);\n  };\n\n  // Tính giảm giá khi mua nhiều\n  const getBulkDiscount = () => {\n    const totalQty = getTotalQuantity();\n    if (totalQty >= promoSettings.bulk_threshold && promoSettings.bulk_discount > 0) {\n      const subtotal = getSubtotal();\n      return Math.round(subtotal * promoSettings.bulk_discount / 100);\n    }\n    return 0;\n  };\n\n  // Xử lý áp dụng voucher\n  const handleApplyVoucher = async (codeOverride = null, options = {}) => {\n    var _ref;\n    const candidate = (_ref = codeOverride !== null && codeOverride !== void 0 ? codeOverride : voucherCode) !== null && _ref !== void 0 ? _ref : '';\n    const effectiveCode = String(candidate).trim();\n    if (!effectiveCode) {\n      setVoucherError('Vui lòng nhập mã voucher');\n      return;\n    }\n    try {\n      const response = await axios.post('/api/vouchers/validate', {\n        code: effectiveCode\n      });\n      const voucher = response.data;\n      const subtotal = getSubtotal() - getBulkDiscount();\n\n      // Check minimum order amount\n      if (subtotal < voucher.min_order_amount) {\n        setVoucherError(`Đơn hàng tối thiểu ${formatVND(voucher.min_order_amount)} để sử dụng voucher này`);\n        setVoucherDiscount(0);\n        if (!options.silent) toast.info('Giá trị đơn hàng chưa đạt điều kiện voucher');\n        return;\n      }\n\n      // Calculate discount\n      let discount = 0;\n      if (voucher.discount_type === 'percent') {\n        discount = Math.round(subtotal * voucher.discount_value / 100);\n        if (voucher.max_discount && discount > voucher.max_discount) {\n          discount = voucher.max_discount;\n        }\n      } else {\n        discount = voucher.discount_value;\n      }\n      setVoucherDiscount(discount);\n      setVoucherError('');\n      setVoucherCode(effectiveCode);\n      if (options.userVoucherId) {\n        setSelectedUserVoucherId(options.userVoucherId);\n      } else if (!options.keepSelection) {\n        setSelectedUserVoucherId(null);\n      }\n      if (!options.silent) toast.success('Áp dụng voucher thành công!');\n    } catch (error) {\n      var _error$response, _error$response$data;\n      setVoucherError(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || 'Mã voucher không hợp lệ');\n      setVoucherDiscount(0);\n      if (!options.silent) toast.error('Áp dụng voucher thất bại');\n    }\n  };\n  const handleSelectSavedVoucher = voucher => {\n    if (!voucher || voucher.is_used) {\n      toast.info('Voucher đã được sử dụng');\n      return;\n    }\n    handleApplyVoucher(voucher.code, {\n      userVoucherId: voucher.user_voucher_id,\n      keepSelection: true\n    });\n  };\n\n  // Tính tổng giảm giá (bulk + voucher)\n  const getTotalDiscount = () => {\n    return getBulkDiscount() + voucherDiscount;\n  };\n  const availableSavedVouchers = myVouchers.filter(v => !v.is_used);\n\n  // Hàm tính phí vận chuyển (tính sau khi trừ giảm giá)\n  const getShippingFee = () => {\n    const subtotalAfterDiscount = getSubtotal() - getTotalDiscount();\n    if (subtotalAfterDiscount >= shippingSettings.free_threshold) {\n      return 0; // Miễn phí ship\n    }\n    return shippingSettings.fee || 0;\n  };\n\n  // Hàm tính tổng cộng (total) của giỏ hàng\n  const getTotal = () => {\n    return getSubtotal() - getTotalDiscount() + getShippingFee();\n  };\n\n  // Hàm xử lý thay đổi dữ liệu trong form\n  const handleInputChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    const next = {\n      ...formData,\n      [name]: value\n    };\n    setFormData(next);\n    // Lưu localStorage\n    if (name === 'paymentMethod') localStorage.setItem('paymentMethod', value);\n    localStorage.setItem('checkoutForm', JSON.stringify({\n      fullName: next.fullName,\n      mobile: next.mobile,\n      address: next.address,\n      state: next.state,\n      note: next.note\n    }));\n    // Validate nhanh từng trường\n    validateField(name, value);\n  };\n  const validateField = (name, value) => {\n    let msg = '';\n    if (['fullName', 'mobile', 'address', 'state'].includes(name) && !value.trim()) msg = 'Vui lòng nhập thông tin.';\n    if (name === 'mobile') {\n      const phoneOk = /^(0[3|5|7|8|9])[0-9]{8}$/.test(value.replace(/\\s+/g, ''));\n      if (!phoneOk) msg = 'Số điện thoại VN không hợp lệ.';\n    }\n    setErrors(prev => ({\n      ...prev,\n      [name]: msg\n    }));\n  };\n  const validateForm = () => {\n    const fields = ['fullName', 'mobile', 'address', 'state'];\n    const newErrors = {};\n    fields.forEach(f => validateField(f, formData[f]));\n    fields.forEach(f => {\n      if (!formData[f] || errors[f] && errors[f].length) newErrors[f] = errors[f] || 'Vui lòng nhập thông tin.';\n    });\n    setErrors(prev => ({\n      ...prev,\n      ...newErrors\n    }));\n    const hasError = fields.some(f => newErrors[f]);\n    return !hasError;\n  };\n\n  // Hàm xử lý đặt hàng\n  const handlePlaceOrder = async () => {\n    // Kiểm tra nếu giỏ hàng trống\n    if (cartItems.length === 0) {\n      toast.info('Giỏ hàng trống. Vui lòng thêm sản phẩm trước khi thanh toán.');\n      return;\n    }\n\n    // Validate form giao hàng\n    if (!validateForm()) {\n      toast.info('Vui lòng kiểm tra lại thông tin giao hàng.');\n      return;\n    }\n    try {\n      var _resp$data;\n      // Tạo dữ liệu đơn hàng\n      const orderData = {\n        // Do not send email field anymore\n        fullName: formData.fullName,\n        mobile: formData.mobile,\n        address: formData.address,\n        state: formData.state,\n        paymentMethod: formData.paymentMethod,\n        note: formData.note,\n        cartItems,\n        total: getTotal(),\n        voucherCode: voucherCode ? voucherCode.trim().toUpperCase() : null,\n        userVoucherId: selectedUserVoucherId\n      };\n\n      // Gửi dữ liệu đơn hàng lên server\n      const token = localStorage.getItem('token');\n      const headers = token ? {\n        'Authorization': `Bearer ${token}`\n      } : {};\n      const resp = await axios.post('/api/orders', orderData, {\n        headers\n      });\n      const updatedSold = resp === null || resp === void 0 ? void 0 : (_resp$data = resp.data) === null || _resp$data === void 0 ? void 0 : _resp$data.updatedSold;\n      toast.success(`Đặt hàng thành công!${typeof updatedSold === 'number' ? ` (cập nhật ${updatedSold} sản phẩm)` : ''}`);\n      localStorage.removeItem('cart'); // Xóa giỏ hàng sau khi đặt hàng thành công\n      // Giữ lại thông tin người nhận cho lần sau, chỉ xóa ghi chú\n      const kept = {\n        ...formData,\n        note: ''\n      };\n      localStorage.setItem('checkoutForm', JSON.stringify({\n        fullName: kept.fullName,\n        mobile: kept.mobile,\n        address: kept.address,\n        state: kept.state,\n        note: kept.note\n      }));\n      // Điều hướng về trang Cửa hàng để refetch dữ liệu và thấy \"Đã bán\" cập nhật\n      setTimeout(() => navigate('/shop'), 300);\n    } catch (error) {\n      console.error('Error placing order:', error);\n      toast.error('Có lỗi xảy ra khi đặt hàng. Vui lòng thử lại.');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid bg-secondary mb-5\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex flex-column align-items-center justify-content-center\",\n        style: {\n          minHeight: '300px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"font-weight-semi-bold text-uppercase mb-3\",\n          children: \"Thanh to\\xE1n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-inline-flex\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"m-0\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"/\",\n              children: \"Trang ch\\u1EE7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 341,\n              columnNumber: 44\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"m-0 px-2\",\n            children: \"-\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 342,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"m-0\",\n            children: \"Thanh to\\xE1n\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid pt-5\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row px-xl-5\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-lg-8\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mb-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"font-weight-semi-bold mb-4\",\n              children: \"Th\\xF4ng tin giao h\\xE0ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"row\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6 form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"H\\u1ECD v\\xE0 t\\xEAn\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 355,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  className: \"form-control\",\n                  type: \"text\",\n                  name: \"fullName\",\n                  value: formData.fullName,\n                  onChange: handleInputChange\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 356,\n                  columnNumber: 37\n                }, this), errors.fullName && /*#__PURE__*/_jsxDEV(\"small\", {\n                  className: \"text-danger\",\n                  children: errors.fullName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 357,\n                  columnNumber: 57\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 354,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6 form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 361,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  className: \"form-control\",\n                  type: \"text\",\n                  name: \"mobile\",\n                  value: formData.mobile,\n                  onChange: handleInputChange\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 362,\n                  columnNumber: 37\n                }, this), errors.mobile && /*#__PURE__*/_jsxDEV(\"small\", {\n                  className: \"text-danger\",\n                  children: errors.mobile\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 363,\n                  columnNumber: 55\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 360,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6 form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"\\u0110\\u1ECBa ch\\u1EC9\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 366,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  className: \"form-control\",\n                  type: \"text\",\n                  name: \"address\",\n                  value: formData.address,\n                  onChange: handleInputChange\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 367,\n                  columnNumber: 37\n                }, this), errors.address && /*#__PURE__*/_jsxDEV(\"small\", {\n                  className: \"text-danger\",\n                  children: errors.address\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 368,\n                  columnNumber: 56\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 365,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6 form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: [\"T\\u1EC9nh/Th\\xE0nh \", /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-danger\",\n                    children: \"*\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 371,\n                    columnNumber: 55\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 371,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                  className: \"form-control\",\n                  name: \"state\",\n                  value: formData.state,\n                  onChange: handleInputChange,\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"\",\n                    disabled: true,\n                    children: \"Ch\\u1ECDn T\\u1EC9nh/Th\\xE0nh n\\u01A1i nh\\u1EADn h\\xE0ng\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 373,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"optgroup\", {\n                    label: \"Ph\\u1ED5 bi\\u1EBFn\",\n                    children: popularProvinces.map(p => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: p,\n                      children: p\n                    }, p, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 376,\n                      columnNumber: 49\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 374,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"optgroup\", {\n                    label: \"Kh\\xE1c\",\n                    children: otherProvinces.map(p => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: p,\n                      children: p\n                    }, p, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 381,\n                      columnNumber: 49\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 379,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 372,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                  className: \"text-muted\",\n                  children: \"Ch\\u1ECDn t\\u1EC9nh/th\\xE0nh \\u0111\\u1EC3 \\u0111\\u1EA3m b\\u1EA3o giao \\u0111\\xFAng khu v\\u1EF1c.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 385,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 385,\n                  columnNumber: 120\n                }, this), errors.state && /*#__PURE__*/_jsxDEV(\"small\", {\n                  className: \"text-danger\",\n                  children: errors.state\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 386,\n                  columnNumber: 54\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 370,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6 form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Ghi ch\\xFA (t\\xF9y ch\\u1ECDn)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 389,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                  className: \"form-control\",\n                  rows: \"1\",\n                  name: \"note\",\n                  value: formData.note,\n                  onChange: handleInputChange\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 390,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 388,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 353,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-lg-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"card border-0 shadow-sm mb-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-header bg-light border-0 text-center\",\n              children: /*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"font-weight-semi-bold m-0 text-uppercase\",\n                children: \"T\\u1ED5ng \\u0111\\u01A1n h\\xE0ng\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 398,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 397,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-body\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between align-items-center mb-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n                  className: \"text-uppercase text-muted mb-0\",\n                  children: \"S\\u1EA3n ph\\u1EA9m\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 402,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(Link, {\n                  to: \"/cart\",\n                  className: \"small text-decoration-none\",\n                  children: \"Ch\\u1EC9nh s\\u1EEDa gi\\u1ECF h\\xE0ng\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 403,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 401,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"order-items-list border rounded p-3 mb-3\",\n                style: {\n                  maxHeight: '240px',\n                  overflowY: 'auto',\n                  backgroundColor: '#fdfdfd'\n                },\n                children: cartItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"py-1\",\n                  style: {\n                    display: 'grid',\n                    gridTemplateColumns: '1fr auto',\n                    alignItems: 'center',\n                    width: '100%'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-truncate\",\n                    style: {\n                      whiteSpace: 'nowrap',\n                      textAlign: 'left'\n                    },\n                    title: item.name,\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"fw-semibold\",\n                      children: item.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 418,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                      className: \"d-block text-muted\",\n                      children: [\"x\", item.quantity || 1]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 419,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 417,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-end fw-semibold\",\n                    style: {\n                      justifySelf: 'end'\n                    },\n                    children: formatVND(parseVND(item.price) * (item.quantity || 1))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 421,\n                    columnNumber: 45\n                  }, this)]\n                }, item.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 407,\n                  columnNumber: 41\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 405,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n                className: \"mt-0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 425,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between mb-2 pt-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n                  className: \"font-weight-medium\",\n                  children: \"T\\u1ED5ng ph\\u1EE5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 427,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n                  className: \"font-weight-medium\",\n                  children: formatVND(getSubtotal())\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 428,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 426,\n                columnNumber: 33\n              }, this), getBulkDiscount() > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between mb-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n                    className: \"font-weight-medium mb-0 text-success\",\n                    children: \"Gi\\u1EA3m gi\\xE1 mua nhi\\u1EC1u\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 433,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                    className: \"text-muted\",\n                    children: [\"Mua t\\u1EEB \", promoSettings.bulk_threshold, \" s\\u1EA3n ph\\u1EA9m: -\", promoSettings.bulk_discount, \"%\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 434,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 432,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n                  className: \"font-weight-medium text-success\",\n                  children: [\"-\", formatVND(getBulkDiscount())]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 436,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 431,\n                columnNumber: 37\n              }, this), promoSettings.enable_voucher && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mb-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"input-group input-group-sm\",\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"text\",\n                    className: `form-control ${voucherError ? 'is-invalid' : ''}`,\n                    placeholder: \"V\\xED d\\u1EE5: WELCOME20K\",\n                    value: voucherCode,\n                    onChange: e => {\n                      setVoucherCode(e.target.value);\n                      setVoucherError('');\n                      setSelectedUserVoucherId(null);\n                    },\n                    onKeyPress: e => {\n                      if (e.key === 'Enter') handleApplyVoucher();\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 442,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn btn-outline-primary\",\n                    type: \"button\",\n                    onClick: handleApplyVoucher,\n                    children: \"\\xC1p d\\u1EE5ng\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 456,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 441,\n                  columnNumber: 41\n                }, this), voucherError && /*#__PURE__*/_jsxDEV(\"small\", {\n                  className: \"text-danger\",\n                  children: voucherError\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 464,\n                  columnNumber: 58\n                }, this), voucherDiscount > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"d-flex justify-content-between mt-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"small\", {\n                    className: \"text-success\",\n                    children: [\"Voucher: \", voucherCode]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 467,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                    className: \"text-success fw-bold\",\n                    children: [\"-\", formatVND(voucherDiscount)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 468,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 466,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mt-3\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"d-flex justify-content-between align-items-center\",\n                    children: [/*#__PURE__*/_jsxDEV(\"small\", {\n                      className: \"text-muted text-uppercase\",\n                      children: \"Voucher c\\u1EE7a b\\u1EA1n\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 473,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(Link, {\n                      to: \"/vouchers\",\n                      className: \"small text-decoration-none\",\n                      children: \"Kho voucher\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 474,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 472,\n                    columnNumber: 45\n                  }, this), loadingMyVouchers ? /*#__PURE__*/_jsxDEV(\"small\", {\n                    className: \"text-muted d-block mt-2\",\n                    children: \"\\u0110ang t\\u1EA3i voucher \\u0111\\xE3 l\\u01B0u...\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 477,\n                    columnNumber: 49\n                  }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                    children: availableSavedVouchers.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"d-flex flex-wrap mt-2\",\n                      style: {\n                        gap: '0.5rem'\n                      },\n                      children: availableSavedVouchers.map(v => {\n                        const isActive = selectedUserVoucherId === v.user_voucher_id;\n                        return /*#__PURE__*/_jsxDEV(\"button\", {\n                          type: \"button\",\n                          className: `btn btn-sm ${isActive ? 'btn-primary text-white' : 'btn-outline-primary'}`,\n                          onClick: () => handleSelectSavedVoucher(v),\n                          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"fw-bold text-uppercase\",\n                            children: v.code\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 491,\n                            columnNumber: 69\n                          }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                            className: `d-block ${isActive ? 'text-light' : 'text-muted'}`,\n                            children: v.discount_type === 'percent' ? `-${v.discount_value}%` : `-${formatVND(v.discount_value)}`\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 492,\n                            columnNumber: 69\n                          }, this)]\n                        }, v.user_voucher_id, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 485,\n                          columnNumber: 65\n                        }, this);\n                      })\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 481,\n                      columnNumber: 57\n                    }, this) : /*#__PURE__*/_jsxDEV(\"small\", {\n                      className: \"text-muted d-block mt-2\",\n                      children: hasAuthToken ? 'Bạn chưa lưu voucher nào' : 'Đăng nhập để xem voucher đã lưu'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 499,\n                      columnNumber: 57\n                    }, this)\n                  }, void 0, false), !hasAuthToken && /*#__PURE__*/_jsxDEV(\"small\", {\n                    className: \"d-block mt-2\",\n                    children: [/*#__PURE__*/_jsxDEV(Link, {\n                      to: \"/login\",\n                      children: \"\\u0110\\u0103ng nh\\u1EADp\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 507,\n                      columnNumber: 53\n                    }, this), \" ho\\u1EB7c \", /*#__PURE__*/_jsxDEV(Link, {\n                      to: \"/signup\",\n                      children: \"t\\u1EA1o t\\xE0i kho\\u1EA3n\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 507,\n                      columnNumber: 93\n                    }, this), \" \\u0111\\u1EC3 s\\u01B0u t\\u1EA7m voucher.\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 506,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 471,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 440,\n                columnNumber: 37\n              }, this), getTotalQuantity() < promoSettings.bulk_threshold && promoSettings.bulk_discount > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"alert alert-info py-2 mb-2\",\n                children: /*#__PURE__*/_jsxDEV(\"small\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fa fa-info-circle me-1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 516,\n                    columnNumber: 45\n                  }, this), \"Mua th\\xEAm \", promoSettings.bulk_threshold - getTotalQuantity(), \" s\\u1EA3n ph\\u1EA9m \\u0111\\u1EC3 \\u0111\\u01B0\\u1EE3c gi\\u1EA3m \", promoSettings.bulk_discount, \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 515,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 514,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between align-items-center mb-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n                    className: \"font-weight-medium mb-0\",\n                    children: \"Ph\\xED v\\u1EADn chuy\\u1EC3n\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 523,\n                    columnNumber: 41\n                  }, this), getSubtotal() - getTotalDiscount() >= shippingSettings.free_threshold ? /*#__PURE__*/_jsxDEV(\"small\", {\n                    className: \"text-success\",\n                    children: [\"Mi\\u1EC5n ph\\xED (\\u0111\\u01A1n \\u2265 \", formatVND(shippingSettings.free_threshold), \")\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 525,\n                    columnNumber: 45\n                  }, this) : /*#__PURE__*/_jsxDEV(\"small\", {\n                    className: \"text-muted\",\n                    children: [\"Mi\\u1EC5n ph\\xED t\\u1EEB \", formatVND(shippingSettings.free_threshold)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 527,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 522,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n                  className: \"font-weight-medium mb-0\",\n                  children: getShippingFee() === 0 ? /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-success\",\n                    children: \"Mi\\u1EC5n ph\\xED\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 532,\n                    columnNumber: 45\n                  }, this) : formatVND(getShippingFee())\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 530,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 521,\n                columnNumber: 33\n              }, this), (shippingSettings.delivery_days || shippingSettings.areas) && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"small text-muted mb-3\",\n                children: [shippingSettings.delivery_days && /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fa fa-clock me-1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 541,\n                    columnNumber: 50\n                  }, this), \"D\\u1EF1 ki\\u1EBFn giao h\\xE0ng: \", shippingSettings.delivery_days, \" ng\\xE0y\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 541,\n                  columnNumber: 45\n                }, this), shippingSettings.areas && /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fa fa-map-marker-alt me-1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 544,\n                    columnNumber: 50\n                  }, this), \"Khu v\\u1EF1c: \", shippingSettings.areas]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 544,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 539,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 400,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-footer bg-transparent border-0 pt-0\",\n              children: [/*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 550,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between align-items-center mt-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                  className: \"font-weight-bold text-uppercase mb-0\",\n                  children: \"T\\u1ED5ng c\\u1ED9ng\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 552,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                  className: \"font-weight-bold text-primary mb-0\",\n                  children: formatVND(getTotal())\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 553,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 551,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 549,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"card border-secondary mb-5\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-header bg-secondary border-0\",\n              children: /*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"font-weight-semi-bold m-0\",\n                children: \"Ph\\u01B0\\u01A1ng th\\u1EE9c thanh to\\xE1n\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 560,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 559,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-body\",\n              children: [paymentSettings.enable_cod && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group mb-2\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"custom-control custom-radio\",\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"radio\",\n                    className: \"custom-control-input\",\n                    name: \"paymentMethod\",\n                    id: \"cod\",\n                    value: \"cod\",\n                    checked: formData.paymentMethod === 'cod',\n                    onChange: handleInputChange\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 566,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"custom-control-label\",\n                    htmlFor: \"cod\",\n                    children: \"Thanh to\\xE1n khi nh\\u1EADn h\\xE0ng (COD)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 575,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 565,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 564,\n                columnNumber: 37\n              }, this), paymentSettings.enable_bank && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group mb-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"custom-control custom-radio\",\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"radio\",\n                    className: \"custom-control-input\",\n                    name: \"paymentMethod\",\n                    id: \"banktransfer\",\n                    value: \"banktransfer\",\n                    checked: formData.paymentMethod === 'banktransfer',\n                    onChange: handleInputChange\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 582,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"custom-control-label\",\n                    htmlFor: \"banktransfer\",\n                    children: \"Chuy\\u1EC3n kho\\u1EA3n ng\\xE2n h\\xE0ng\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 591,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 581,\n                  columnNumber: 41\n                }, this), formData.paymentMethod === 'banktransfer' && paymentSettings.bank_info && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mt-3 p-3 bg-light rounded border\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"small\",\n                    style: {\n                      whiteSpace: 'pre-line'\n                    },\n                    children: paymentSettings.bank_info.split('\\n').map((line, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"mb-1\",\n                      children: line\n                    }, idx, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 597,\n                      columnNumber: 57\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 595,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-2 mb-0\",\n                    children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: \"N\\u1ED9i dung chuy\\u1EC3n kho\\u1EA3n:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 601,\n                      columnNumber: 53\n                    }, this), \" DH-\", new Date().getFullYear(), \"-\", /*#__PURE__*/_jsxDEV(\"em\", {\n                      children: formData.mobile || 'SĐT'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 601,\n                      columnNumber: 123\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      className: \"btn btn-sm btn-outline-secondary ms-2\",\n                      onClick: () => {\n                        const content = `DH-${new Date().getFullYear()}-${formData.mobile || 'SĐT'}`;\n                        navigator.clipboard.writeText(content);\n                        toast.success('Đã copy nội dung chuyển khoản');\n                      },\n                      children: \"Copy\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 602,\n                      columnNumber: 53\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 600,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 594,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 580,\n                columnNumber: 37\n              }, this), paymentSettings.enable_ewallet && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group mb-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"custom-control custom-radio\",\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"radio\",\n                    className: \"custom-control-input\",\n                    name: \"paymentMethod\",\n                    id: \"ewallet\",\n                    value: \"ewallet\",\n                    checked: formData.paymentMethod === 'ewallet',\n                    onChange: handleInputChange\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 617,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"custom-control-label\",\n                    htmlFor: \"ewallet\",\n                    children: \"V\\xED \\u0111i\\u1EC7n t\\u1EED (Momo, ZaloPay)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 626,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 616,\n                  columnNumber: 41\n                }, this), formData.paymentMethod === 'ewallet' && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mt-3 p-3 bg-light rounded border\",\n                  children: /*#__PURE__*/_jsxDEV(\"small\", {\n                    className: \"text-muted\",\n                    children: \"Thanh to\\xE1n qua v\\xED \\u0111i\\u1EC7n t\\u1EED s\\u1EBD \\u0111\\u01B0\\u1EE3c x\\u1EED l\\xFD sau khi \\u0111\\u1EB7t h\\xE0ng.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 630,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 629,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 615,\n                columnNumber: 37\n              }, this), !paymentSettings.enable_cod && !paymentSettings.enable_bank && !paymentSettings.enable_ewallet && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"alert alert-warning\",\n                children: /*#__PURE__*/_jsxDEV(\"small\", {\n                  children: \"Hi\\u1EC7n t\\u1EA1i kh\\xF4ng c\\xF3 ph\\u01B0\\u01A1ng th\\u1EE9c thanh to\\xE1n n\\xE0o \\u0111\\u01B0\\u1EE3c k\\xEDch ho\\u1EA1t. Vui l\\xF2ng li\\xEAn h\\u1EC7 admin.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 637,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 636,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 562,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-footer border-secondary bg-transparent\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-lg btn-block btn-primary font-weight-bold my-3 py-3\",\n                onClick: () => {\n                  if (!formData.paymentMethod) {\n                    toast.info('Vui lòng chọn phương thức thanh toán');\n                    return;\n                  }\n                  if (!validateForm()) return;\n                  handlePlaceOrder();\n                },\n                children: \"\\u0110\\u1EB7t h\\xE0ng\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 642,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 641,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 558,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 660,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 334,\n    columnNumber: 9\n  }, this);\n}\n_s(Checkout, \"VCCKRJPDiAxsqHbe1ai7xzjBVLQ=\", false, function () {\n  return [useNavigate];\n});\n_c = Checkout;\nexport default Checkout;\nvar _c;\n$RefreshReg$(_c, \"Checkout\");","map":{"version":3,"names":["React","Fragment","useEffect","useState","useNavigate","Link","Header","Footer","axios","parseVND","formatVND","toast","jsxDEV","_jsxDEV","_Fragment","Checkout","_s","cartItems","setCartItems","formData","setFormData","fullName","mobile","address","state","paymentMethod","note","errors","setErrors","shippingSettings","setShippingSettings","fee","free_threshold","delivery_days","areas","promoSettings","setPromoSettings","bulk_discount","bulk_threshold","enable_voucher","paymentSettings","setPaymentSettings","enable_cod","enable_bank","enable_ewallet","bank_info","voucherCode","setVoucherCode","voucherDiscount","setVoucherDiscount","voucherError","setVoucherError","myVouchers","setMyVouchers","selectedUserVoucherId","setSelectedUserVoucherId","loadingMyVouchers","setLoadingMyVouchers","hasAuthToken","setHasAuthToken","localStorage","getItem","navigate","popularProvinces","otherProvinces","storedCart","JSON","parse","savedMethod","prev","savedForm","parsed","email","get","then","response","data","settings","Object","keys","forEach","key","value","parseInt","catch","error","console","token","headers","Array","isArray","finally","getSubtotal","reduce","total","item","unit","price","quantity","getTotalQuantity","getBulkDiscount","totalQty","subtotal","Math","round","handleApplyVoucher","codeOverride","options","_ref","candidate","effectiveCode","String","trim","post","code","voucher","min_order_amount","silent","info","discount","discount_type","discount_value","max_discount","userVoucherId","keepSelection","success","_error$response","_error$response$data","message","handleSelectSavedVoucher","is_used","user_voucher_id","getTotalDiscount","availableSavedVouchers","filter","v","getShippingFee","subtotalAfterDiscount","getTotal","handleInputChange","e","name","target","next","setItem","stringify","validateField","msg","includes","phoneOk","test","replace","validateForm","fields","newErrors","f","length","hasError","some","handlePlaceOrder","_resp$data","orderData","toUpperCase","resp","updatedSold","removeItem","kept","setTimeout","children","fileName","_jsxFileName","lineNumber","columnNumber","className","style","minHeight","href","type","onChange","disabled","label","map","p","rows","to","maxHeight","overflowY","backgroundColor","display","gridTemplateColumns","alignItems","width","whiteSpace","textAlign","title","justifySelf","id","placeholder","onKeyPress","onClick","gap","isActive","checked","htmlFor","split","line","idx","Date","getFullYear","content","navigator","clipboard","writeText","_c","$RefreshReg$"],"sources":["C:/Trần Minh Quý/Chuyên đề Nodejs và React/2200008995_TranMinhQuy/2200008995_TranMinhQuy/ProjectReactNodejs/SHOPBANSACH/frontend/src/pages/Checkout.js"],"sourcesContent":["import React, { Fragment, useEffect, useState } from \"react\";\nimport { useNavigate, Link } from 'react-router-dom';\nimport Header from \"./Header\";\nimport Footer from \"./Footer\";\nimport axios from 'axios';\nimport { parseVND, formatVND } from '../utils/currency';\nimport { toast } from 'react-toastify';\n\nfunction Checkout() {\n    // Khai báo các biến trạng thái\n    const [cartItems, setCartItems] = useState([]); // Danh sách sản phẩm trong giỏ hàng\n    const [formData, setFormData] = useState({\n        fullName: '', // Họ và tên\n        mobile: '', // Số điện thoại\n        address: '', // Địa chỉ\n        state: '', // Tỉnh/Thành phố\n        paymentMethod: '', // Phương thức thanh toán\n        note: '' // Ghi chú (tùy chọn)\n    });\n    const [errors, setErrors] = useState({});\n    const [shippingSettings, setShippingSettings] = useState({\n        fee: 30000,\n        free_threshold: 500000,\n        delivery_days: 3,\n        areas: 'Toàn quốc'\n    });\n    const [promoSettings, setPromoSettings] = useState({\n        bulk_discount: 0,\n        bulk_threshold: 5,\n        enable_voucher: false\n    });\n    const [paymentSettings, setPaymentSettings] = useState({\n        enable_cod: true,\n        enable_bank: false,\n        enable_ewallet: false,\n        bank_info: ''\n    });\n    const [voucherCode, setVoucherCode] = useState('');\n    const [voucherDiscount, setVoucherDiscount] = useState(0);\n    const [voucherError, setVoucherError] = useState('');\n    const [myVouchers, setMyVouchers] = useState([]);\n    const [selectedUserVoucherId, setSelectedUserVoucherId] = useState(null);\n    const [loadingMyVouchers, setLoadingMyVouchers] = useState(false);\n    const [hasAuthToken, setHasAuthToken] = useState(!!localStorage.getItem('token'));\n    const navigate = useNavigate();\n\n    const popularProvinces = [\n        'Hồ Chí Minh','Hà Nội','Đà Nẵng','Cần Thơ','Bình Dương','Đồng Nai','Hải Phòng'\n    ];\n    const otherProvinces = [\n        'An Giang','Bà Rịa - Vũng Tàu','Bắc Giang','Bắc Kạn','Bạc Liêu','Bắc Ninh','Bến Tre','Bình Định','Bình Phước','Bình Thuận','Cà Mau','Cao Bằng','Đắk Lắk','Đắk Nông','Điện Biên','Đồng Tháp','Gia Lai','Hà Giang','Hà Nam','Hà Tĩnh','Hải Dương','Hậu Giang','Hòa Bình','Hưng Yên','Khánh Hòa','Kiên Giang','Kon Tum','Lai Châu','Lâm Đồng','Lạng Sơn','Lào Cai','Long An','Nam Định','Nghệ An','Ninh Bình','Ninh Thuận','Phú Thọ','Phú Yên','Quảng Bình','Quảng Nam','Quảng Ngãi','Quảng Ninh','Quảng Trị','Sóc Trăng','Sơn La','Tây Ninh','Thái Bình','Thái Nguyên','Thanh Hóa','Thừa Thiên Huế','Tiền Giang','Trà Vinh','Tuyên Quang','Vĩnh Long','Vĩnh Phúc','Yên Bái'\n    ];\n\n    // Sử dụng useEffect để lấy giỏ hàng từ localStorage \n    useEffect(() => {\n        const storedCart = localStorage.getItem(\"cart\");\n        if (storedCart) {\n            setCartItems(JSON.parse(storedCart));\n        }\n        // Khôi phục phương thức thanh toán\n        const savedMethod = localStorage.getItem('paymentMethod');\n        if (savedMethod) {\n            setFormData((prev) => ({...prev, paymentMethod: savedMethod}));\n        } else {\n            // default chọn COD nếu được bật, nếu không thì chọn phương thức đầu tiên có sẵn\n            // Sẽ được set sau khi load settings\n        }\n\n        // Khôi phục dữ liệu form\n        const savedForm = localStorage.getItem('checkoutForm');\n        if (savedForm) {\n            try {\n                const parsed = JSON.parse(savedForm);\n                // Ignore any legacy `email` stored previously\n                if (parsed && parsed.email) delete parsed.email;\n                setFormData((prev) => ({...prev, ...parsed}));\n            } catch {}\n        }\n\n        // Fetch settings\n        axios.get('/api/settings')\n            .then(response => {\n                if (response.data && typeof response.data === 'object') {\n                    const settings = {};\n                    Object.keys(response.data).forEach(key => {\n                        settings[key] = response.data[key].value || '';\n                    });\n                    setShippingSettings({\n                        fee: parseInt(settings['shipping.fee']) || 30000,\n                        free_threshold: parseInt(settings['shipping.free_threshold']) || 500000,\n                        delivery_days: parseInt(settings['shipping.delivery_days']) || 3,\n                        areas: settings['shipping.areas'] || 'Toàn quốc'\n                    });\n                    setPromoSettings({\n                        bulk_discount: parseInt(settings['promo.bulk_discount']) || 0,\n                        bulk_threshold: parseInt(settings['promo.bulk_threshold']) || 5,\n                        enable_voucher: settings['promo.enable_voucher'] === 'true'\n                    });\n                    const paymentSettings = {\n                        enable_cod: settings['payment.enable_cod'] === 'true',\n                        enable_bank: settings['payment.enable_bank'] === 'true',\n                        enable_ewallet: settings['payment.enable_ewallet'] === 'true',\n                        bank_info: settings['payment.bank_info'] || ''\n                    };\n                    setPaymentSettings(paymentSettings);\n                    \n                    // Set default payment method if not set\n                    if (!formData.paymentMethod) {\n                        if (paymentSettings.enable_cod) {\n                            setFormData((prev) => ({...prev, paymentMethod: 'cod'}));\n                        } else if (paymentSettings.enable_bank) {\n                            setFormData((prev) => ({...prev, paymentMethod: 'banktransfer'}));\n                        } else if (paymentSettings.enable_ewallet) {\n                            setFormData((prev) => ({...prev, paymentMethod: 'ewallet'}));\n                        }\n                    }\n                }\n            })\n            .catch(error => {\n                console.error('Error fetching settings:', error);\n            });\n\n        const token = localStorage.getItem('token');\n        setHasAuthToken(!!token);\n        if (token) {\n            setLoadingMyVouchers(true);\n            axios.get('/api/my-vouchers', { headers: { 'Authorization': `Bearer ${token}` } })\n                .then(response => {\n                    setMyVouchers(Array.isArray(response.data) ? response.data : []);\n                })\n                .catch(error => {\n                    console.error('Error fetching my vouchers:', error);\n                })\n                .finally(() => setLoadingMyVouchers(false));\n        }\n    }, []);\n\n    // Hàm tính tổng phụ (subtotal) của giỏ hàng - chuẩn hoá giá VND\n    const getSubtotal = () => {\n        return cartItems.reduce((total, item) => {\n            const unit = parseVND(item.price);\n            return total + unit * (item.quantity || 1);\n        }, 0);\n    };\n\n    // Tính tổng số lượng sản phẩm\n    const getTotalQuantity = () => {\n        return cartItems.reduce((total, item) => total + (item.quantity || 1), 0);\n    };\n\n    // Tính giảm giá khi mua nhiều\n    const getBulkDiscount = () => {\n        const totalQty = getTotalQuantity();\n        if (totalQty >= promoSettings.bulk_threshold && promoSettings.bulk_discount > 0) {\n            const subtotal = getSubtotal();\n            return Math.round(subtotal * promoSettings.bulk_discount / 100);\n        }\n        return 0;\n    };\n\n    // Xử lý áp dụng voucher\n    const handleApplyVoucher = async (codeOverride = null, options = {}) => {\n        const candidate = codeOverride ?? voucherCode ?? '';\n        const effectiveCode = String(candidate).trim();\n        if (!effectiveCode) {\n            setVoucherError('Vui lòng nhập mã voucher');\n            return;\n        }\n        \n        try {\n            const response = await axios.post('/api/vouchers/validate', { code: effectiveCode });\n            const voucher = response.data;\n            const subtotal = getSubtotal() - getBulkDiscount();\n            \n            // Check minimum order amount\n            if (subtotal < voucher.min_order_amount) {\n                setVoucherError(`Đơn hàng tối thiểu ${formatVND(voucher.min_order_amount)} để sử dụng voucher này`);\n                setVoucherDiscount(0);\n                if (!options.silent) toast.info('Giá trị đơn hàng chưa đạt điều kiện voucher');\n                return;\n            }\n            \n            // Calculate discount\n            let discount = 0;\n            if (voucher.discount_type === 'percent') {\n                discount = Math.round(subtotal * voucher.discount_value / 100);\n                if (voucher.max_discount && discount > voucher.max_discount) {\n                    discount = voucher.max_discount;\n                }\n            } else {\n                discount = voucher.discount_value;\n            }\n            \n            setVoucherDiscount(discount);\n            setVoucherError('');\n            setVoucherCode(effectiveCode);\n            if (options.userVoucherId) {\n                setSelectedUserVoucherId(options.userVoucherId);\n            } else if (!options.keepSelection) {\n                setSelectedUserVoucherId(null);\n            }\n            if (!options.silent) toast.success('Áp dụng voucher thành công!');\n        } catch (error) {\n            setVoucherError(error.response?.data?.message || 'Mã voucher không hợp lệ');\n            setVoucherDiscount(0);\n            if (!options.silent) toast.error('Áp dụng voucher thất bại');\n        }\n    };\n\n    const handleSelectSavedVoucher = (voucher) => {\n        if (!voucher || voucher.is_used) {\n            toast.info('Voucher đã được sử dụng');\n            return;\n        }\n        handleApplyVoucher(voucher.code, { userVoucherId: voucher.user_voucher_id, keepSelection: true });\n    };\n\n    // Tính tổng giảm giá (bulk + voucher)\n    const getTotalDiscount = () => {\n        return getBulkDiscount() + voucherDiscount;\n    };\n\n    const availableSavedVouchers = myVouchers.filter(v => !v.is_used);\n\n    // Hàm tính phí vận chuyển (tính sau khi trừ giảm giá)\n    const getShippingFee = () => {\n        const subtotalAfterDiscount = getSubtotal() - getTotalDiscount();\n        if (subtotalAfterDiscount >= shippingSettings.free_threshold) {\n            return 0; // Miễn phí ship\n        }\n        return shippingSettings.fee || 0;\n    };\n\n    // Hàm tính tổng cộng (total) của giỏ hàng\n    const getTotal = () => {\n        return getSubtotal() - getTotalDiscount() + getShippingFee();\n    };\n\n    // Hàm xử lý thay đổi dữ liệu trong form\n    const handleInputChange = (e) => {\n        const { name, value } = e.target;\n        const next = { ...formData, [name]: value };\n        setFormData(next);\n        // Lưu localStorage\n        if (name === 'paymentMethod') localStorage.setItem('paymentMethod', value);\n        localStorage.setItem('checkoutForm', JSON.stringify({\n            fullName: next.fullName,\n            mobile: next.mobile,\n            address: next.address,\n            state: next.state,\n            note: next.note\n        }));\n        // Validate nhanh từng trường\n        validateField(name, value);\n    };\n\n    const validateField = (name, value) => {\n        let msg = '';\n        if (['fullName','mobile','address','state'].includes(name) && !value.trim()) msg = 'Vui lòng nhập thông tin.';\n        if (name === 'mobile') {\n            const phoneOk = /^(0[3|5|7|8|9])[0-9]{8}$/.test(value.replace(/\\s+/g,''));\n            if (!phoneOk) msg = 'Số điện thoại VN không hợp lệ.';\n        }\n        setErrors(prev => ({...prev, [name]: msg}));\n    };\n\n    const validateForm = () => {\n        const fields = ['fullName','mobile','address','state'];\n        const newErrors = {};\n        fields.forEach(f => validateField(f, formData[f]));\n        fields.forEach(f => {\n            if (!formData[f] || (errors[f] && errors[f].length)) newErrors[f] = errors[f] || 'Vui lòng nhập thông tin.';\n        });\n        setErrors(prev => ({...prev, ...newErrors}));\n        const hasError = fields.some(f => newErrors[f]);\n        return !hasError;\n    };\n\n    // Hàm xử lý đặt hàng\n    const handlePlaceOrder = async () => {\n        // Kiểm tra nếu giỏ hàng trống\n        if (cartItems.length === 0) {\n            toast.info('Giỏ hàng trống. Vui lòng thêm sản phẩm trước khi thanh toán.');\n            return;\n        }\n\n        // Validate form giao hàng\n        if (!validateForm()) {\n            toast.info('Vui lòng kiểm tra lại thông tin giao hàng.');\n            return;\n        }\n\n        try {\n            // Tạo dữ liệu đơn hàng\n            const orderData = {\n                // Do not send email field anymore\n                fullName: formData.fullName,\n                mobile: formData.mobile,\n                address: formData.address,\n                state: formData.state,\n                paymentMethod: formData.paymentMethod,\n                note: formData.note,\n                cartItems,\n                total: getTotal(),\n                voucherCode: voucherCode ? voucherCode.trim().toUpperCase() : null,\n                userVoucherId: selectedUserVoucherId\n            };\n\n            // Gửi dữ liệu đơn hàng lên server\n            const token = localStorage.getItem('token');\n            const headers = token ? { 'Authorization': `Bearer ${token}` } : {};\n            const resp = await axios.post('/api/orders', orderData, { headers });\n            const updatedSold = resp?.data?.updatedSold;\n            toast.success(`Đặt hàng thành công!${typeof updatedSold === 'number' ? ` (cập nhật ${updatedSold} sản phẩm)` : ''}`);\n            localStorage.removeItem('cart'); // Xóa giỏ hàng sau khi đặt hàng thành công\n            // Giữ lại thông tin người nhận cho lần sau, chỉ xóa ghi chú\n            const kept = {...formData, note: ''};\n            localStorage.setItem('checkoutForm', JSON.stringify({\n                fullName: kept.fullName,\n                mobile: kept.mobile,\n                address: kept.address,\n                state: kept.state,\n                note: kept.note\n            }));\n            // Điều hướng về trang Cửa hàng để refetch dữ liệu và thấy \"Đã bán\" cập nhật\n            setTimeout(() => navigate('/shop'), 300);\n        } catch (error) {\n            console.error('Error placing order:', error);\n            toast.error('Có lỗi xảy ra khi đặt hàng. Vui lòng thử lại.');\n        }\n    };\n\n    return (\n        <Fragment>\n            <Header />\n\n            <div className=\"container-fluid bg-secondary mb-5\">\n                <div className=\"d-flex flex-column align-items-center justify-content-center\" style={{ minHeight: '300px' }}>\n                    <h1 className=\"font-weight-semi-bold text-uppercase mb-3\">Thanh toán</h1>\n                    <div className=\"d-inline-flex\">\n                        <p className=\"m-0\"><a href=\"/\">Trang chủ</a></p>\n                        <p className=\"m-0 px-2\">-</p>\n                        <p className=\"m-0\">Thanh toán</p>\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"container-fluid pt-5\">\n                <div className=\"row px-xl-5\">\n                    <div className=\"col-lg-8\">\n                        <div className=\"mb-4\">\n                            <h4 className=\"font-weight-semi-bold mb-4\">Thông tin giao hàng</h4>\n                            <div className=\"row\">\n                                <div className=\"col-md-6 form-group\">\n                                    <label>Họ và tên</label>\n                                    <input className=\"form-control\" type=\"text\" name=\"fullName\" value={formData.fullName} onChange={handleInputChange} />\n                                    {errors.fullName && <small className=\"text-danger\">{errors.fullName}</small>}\n                                </div>\n                                {/* Email field removed: we no longer collect a separate shipping email */}\n                                <div className=\"col-md-6 form-group\">\n                                    <label>Số điện thoại</label>\n                                    <input className=\"form-control\" type=\"text\" name=\"mobile\" value={formData.mobile} onChange={handleInputChange} />\n                                    {errors.mobile && <small className=\"text-danger\">{errors.mobile}</small>}\n                                </div>\n                                <div className=\"col-md-6 form-group\">\n                                    <label>Địa chỉ</label>\n                                    <input className=\"form-control\" type=\"text\" name=\"address\" value={formData.address} onChange={handleInputChange} />\n                                    {errors.address && <small className=\"text-danger\">{errors.address}</small>}\n                                </div>\n                                <div className=\"col-md-6 form-group\">\n                                    <label>Tỉnh/Thành <span className=\"text-danger\">*</span></label>\n                                    <select className=\"form-control\" name=\"state\" value={formData.state} onChange={handleInputChange}>\n                                        <option value=\"\" disabled>Chọn Tỉnh/Thành nơi nhận hàng</option>\n                                        <optgroup label=\"Phổ biến\">\n                                            {popularProvinces.map(p => (\n                                                <option key={p} value={p}>{p}</option>\n                                            ))}\n                                        </optgroup>\n                                        <optgroup label=\"Khác\">\n                                            {otherProvinces.map(p => (\n                                                <option key={p} value={p}>{p}</option>\n                                            ))}\n                                        </optgroup>\n                                    </select>\n                                    <small className=\"text-muted\">Chọn tỉnh/thành để đảm bảo giao đúng khu vực.</small><br/>\n                                    {errors.state && <small className=\"text-danger\">{errors.state}</small>}\n                                </div>\n                                <div className=\"col-md-6 form-group\">\n                                    <label>Ghi chú (tùy chọn)</label>\n                                    <textarea className=\"form-control\" rows=\"1\" name=\"note\" value={formData.note} onChange={handleInputChange}></textarea>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"col-lg-4\">\n                        <div className=\"card border-0 shadow-sm mb-4\">\n                            <div className=\"card-header bg-light border-0 text-center\">\n                                <h4 className=\"font-weight-semi-bold m-0 text-uppercase\">Tổng đơn hàng</h4>\n                            </div>\n                            <div className=\"card-body\">\n                                <div className=\"d-flex justify-content-between align-items-center mb-3\">\n                                    <h6 className=\"text-uppercase text-muted mb-0\">Sản phẩm</h6>\n                                    <Link to=\"/cart\" className=\"small text-decoration-none\">Chỉnh sửa giỏ hàng</Link>\n                                </div>\n                                <div className=\"order-items-list border rounded p-3 mb-3\" style={{maxHeight:'240px', overflowY:'auto', backgroundColor:'#fdfdfd'}}>\n                                    {cartItems.map((item) => (\n                                        <div\n                                            key={item.id}\n                                            className=\"py-1\"\n                                            style={{\n                                                display: 'grid',\n                                                gridTemplateColumns: '1fr auto',\n                                                alignItems: 'center',\n                                                width: '100%'\n                                            }}\n                                        >\n                                            <div className=\"text-truncate\" style={{whiteSpace:'nowrap', textAlign:'left'}} title={item.name}>\n                                                <span className=\"fw-semibold\">{item.name}</span>\n                                                <small className=\"d-block text-muted\">x{item.quantity || 1}</small>\n                                            </div>\n                                            <span className=\"text-end fw-semibold\" style={{justifySelf:'end'}}>{formatVND(parseVND(item.price) * (item.quantity || 1))}</span>\n                                        </div>\n                                    ))}\n                                </div>\n                                <hr className=\"mt-0\" />\n                                <div className=\"d-flex justify-content-between mb-2 pt-1\">\n                                    <h6 className=\"font-weight-medium\">Tổng phụ</h6>\n                                    <h6 className=\"font-weight-medium\">{formatVND(getSubtotal())}</h6>\n                                </div>\n                                {getBulkDiscount() > 0 && (\n                                    <div className=\"d-flex justify-content-between mb-2\">\n                                        <div>\n                                            <h6 className=\"font-weight-medium mb-0 text-success\">Giảm giá mua nhiều</h6>\n                                            <small className=\"text-muted\">Mua từ {promoSettings.bulk_threshold} sản phẩm: -{promoSettings.bulk_discount}%</small>\n                                        </div>\n                                        <h6 className=\"font-weight-medium text-success\">-{formatVND(getBulkDiscount())}</h6>\n                                    </div>\n                                )}\n                                {promoSettings.enable_voucher && (\n                                    <div className=\"mb-2\">\n                                        <div className=\"input-group input-group-sm\">\n                                            <input \n                                                type=\"text\" \n                                            className={`form-control ${voucherError ? 'is-invalid' : ''}`}\n                                            placeholder=\"Ví dụ: WELCOME20K\"\n                                                value={voucherCode}\n                                                onChange={(e) => {\n                                                    setVoucherCode(e.target.value);\n                                                    setVoucherError('');\n                                                    setSelectedUserVoucherId(null);\n                                                }}\n                                                onKeyPress={(e) => {\n                                                    if (e.key === 'Enter') handleApplyVoucher();\n                                                }}\n                                            />\n                                            <button \n                                                className=\"btn btn-outline-primary\" \n                                                type=\"button\"\n                                                onClick={handleApplyVoucher}\n                                            >\n                                                Áp dụng\n                                            </button>\n                                        </div>\n                                        {voucherError && <small className=\"text-danger\">{voucherError}</small>}\n                                        {voucherDiscount > 0 && (\n                                            <div className=\"d-flex justify-content-between mt-2\">\n                                                <small className=\"text-success\">Voucher: {voucherCode}</small>\n                                                <small className=\"text-success fw-bold\">-{formatVND(voucherDiscount)}</small>\n                                            </div>\n                                        )}\n                                        <div className=\"mt-3\">\n                                            <div className=\"d-flex justify-content-between align-items-center\">\n                                                <small className=\"text-muted text-uppercase\">Voucher của bạn</small>\n                                                <Link to=\"/vouchers\" className=\"small text-decoration-none\">Kho voucher</Link>\n                                            </div>\n                                            {loadingMyVouchers ? (\n                                                <small className=\"text-muted d-block mt-2\">Đang tải voucher đã lưu...</small>\n                                            ) : (\n                                                <>\n                                                    {availableSavedVouchers.length > 0 ? (\n                                                        <div className=\"d-flex flex-wrap mt-2\" style={{ gap: '0.5rem' }}>\n                                                            {availableSavedVouchers.map(v => {\n                                                                const isActive = selectedUserVoucherId === v.user_voucher_id;\n                                                                return (\n                                                                <button\n                                                                    type=\"button\"\n                                                                    key={v.user_voucher_id}\n                                                                    className={`btn btn-sm ${isActive ? 'btn-primary text-white' : 'btn-outline-primary'}`}\n                                                                    onClick={() => handleSelectSavedVoucher(v)}\n                                                                >\n                                                                    <div className=\"fw-bold text-uppercase\">{v.code}</div>\n                                                                    <small className={`d-block ${isActive ? 'text-light' : 'text-muted'}`}>\n                                                                        {v.discount_type === 'percent' ? `-${v.discount_value}%` : `-${formatVND(v.discount_value)}`}\n                                                                    </small>\n                                                                </button>\n                                                            );})}\n                                                        </div>\n                                                    ) : (\n                                                        <small className=\"text-muted d-block mt-2\">\n                                                            {hasAuthToken ? 'Bạn chưa lưu voucher nào' : 'Đăng nhập để xem voucher đã lưu'}\n                                                        </small>\n                                                    )}\n                                                </>\n                                            )}\n                                            {!hasAuthToken && (\n                                                <small className=\"d-block mt-2\">\n                                                    <Link to=\"/login\">Đăng nhập</Link> hoặc <Link to=\"/signup\">tạo tài khoản</Link> để sưu tầm voucher.\n                                                </small>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n                                {getTotalQuantity() < promoSettings.bulk_threshold && promoSettings.bulk_discount > 0 && (\n                                    <div className=\"alert alert-info py-2 mb-2\">\n                                        <small>\n                                            <i className=\"fa fa-info-circle me-1\"></i>\n                                            Mua thêm {promoSettings.bulk_threshold - getTotalQuantity()} sản phẩm để được giảm {promoSettings.bulk_discount}%\n                                        </small>\n                                    </div>\n                                )}\n                                <div className=\"d-flex justify-content-between align-items-center mb-3\">\n                                    <div>\n                                        <h6 className=\"font-weight-medium mb-0\">Phí vận chuyển</h6>\n                                        {(getSubtotal() - getTotalDiscount()) >= shippingSettings.free_threshold ? (\n                                            <small className=\"text-success\">Miễn phí (đơn ≥ {formatVND(shippingSettings.free_threshold)})</small>\n                                        ) : (\n                                            <small className=\"text-muted\">Miễn phí từ {formatVND(shippingSettings.free_threshold)}</small>\n                                        )}\n                                    </div>\n                                    <h6 className=\"font-weight-medium mb-0\">\n                                        {getShippingFee() === 0 ? (\n                                            <span className=\"text-success\">Miễn phí</span>\n                                        ) : (\n                                            formatVND(getShippingFee())\n                                        )}\n                                    </h6>\n                                </div>\n                                {(shippingSettings.delivery_days || shippingSettings.areas) && (\n                                    <div className=\"small text-muted mb-3\">\n                                        {shippingSettings.delivery_days && (\n                                            <div><i className=\"fa fa-clock me-1\"></i>Dự kiến giao hàng: {shippingSettings.delivery_days} ngày</div>\n                                        )}\n                                        {shippingSettings.areas && (\n                                            <div><i className=\"fa fa-map-marker-alt me-1\"></i>Khu vực: {shippingSettings.areas}</div>\n                                        )}\n                                    </div>\n                                )}\n                            </div>\n                            <div className=\"card-footer bg-transparent border-0 pt-0\">\n                                <hr />\n                                <div className=\"d-flex justify-content-between align-items-center mt-2\">\n                                    <h5 className=\"font-weight-bold text-uppercase mb-0\">Tổng cộng</h5>\n                                    <h4 className=\"font-weight-bold text-primary mb-0\">{formatVND(getTotal())}</h4>\n                                </div>\n                            </div>\n                        </div>\n                        {/* Các lựa chọn phương thức thanh toán */}\n                        <div className=\"card border-secondary mb-5\">\n                            <div className=\"card-header bg-secondary border-0\">\n                                <h4 className=\"font-weight-semi-bold m-0\">Phương thức thanh toán</h4>\n                            </div>\n                            <div className=\"card-body\">\n                                {paymentSettings.enable_cod && (\n                                    <div className=\"form-group mb-2\">\n                                        <div className=\"custom-control custom-radio\">\n                                            <input\n                                                type=\"radio\"\n                                                className=\"custom-control-input\"\n                                                name=\"paymentMethod\"\n                                                id=\"cod\"\n                                                value=\"cod\"\n                                                checked={formData.paymentMethod === 'cod'}\n                                                onChange={handleInputChange}\n                                            />\n                                            <label className=\"custom-control-label\" htmlFor=\"cod\">Thanh toán khi nhận hàng (COD)</label>\n                                        </div>\n                                    </div>\n                                )}\n                                {paymentSettings.enable_bank && (\n                                    <div className=\"form-group mb-2\">\n                                        <div className=\"custom-control custom-radio\">\n                                            <input\n                                                type=\"radio\"\n                                                className=\"custom-control-input\"\n                                                name=\"paymentMethod\"\n                                                id=\"banktransfer\"\n                                                value=\"banktransfer\"\n                                                checked={formData.paymentMethod === 'banktransfer'}\n                                                onChange={handleInputChange}\n                                            />\n                                            <label className=\"custom-control-label\" htmlFor=\"banktransfer\">Chuyển khoản ngân hàng</label>\n                                        </div>\n                                        {formData.paymentMethod === 'banktransfer' && paymentSettings.bank_info && (\n                                            <div className=\"mt-3 p-3 bg-light rounded border\">\n                                                <div className=\"small\" style={{ whiteSpace: 'pre-line' }}>\n                                                    {paymentSettings.bank_info.split('\\n').map((line, idx) => (\n                                                        <div key={idx} className=\"mb-1\">{line}</div>\n                                                    ))}\n                                                </div>\n                                                <div className=\"mt-2 mb-0\">\n                                                    <strong>Nội dung chuyển khoản:</strong> DH-{new Date().getFullYear()}-<em>{formData.mobile || 'SĐT'}</em>\n                                                    <button\n                                                        className=\"btn btn-sm btn-outline-secondary ms-2\"\n                                                        onClick={() => {\n                                                            const content = `DH-${new Date().getFullYear()}-${formData.mobile || 'SĐT'}`;\n                                                            navigator.clipboard.writeText(content);\n                                                            toast.success('Đã copy nội dung chuyển khoản');\n                                                        }}>Copy</button>\n                                                </div>\n                                            </div>\n                                        )}\n                                    </div>\n                                )}\n                                {paymentSettings.enable_ewallet && (\n                                    <div className=\"form-group mb-2\">\n                                        <div className=\"custom-control custom-radio\">\n                                            <input\n                                                type=\"radio\"\n                                                className=\"custom-control-input\"\n                                                name=\"paymentMethod\"\n                                                id=\"ewallet\"\n                                                value=\"ewallet\"\n                                                checked={formData.paymentMethod === 'ewallet'}\n                                                onChange={handleInputChange}\n                                            />\n                                            <label className=\"custom-control-label\" htmlFor=\"ewallet\">Ví điện tử (Momo, ZaloPay)</label>\n                                        </div>\n                                        {formData.paymentMethod === 'ewallet' && (\n                                            <div className=\"mt-3 p-3 bg-light rounded border\">\n                                                <small className=\"text-muted\">Thanh toán qua ví điện tử sẽ được xử lý sau khi đặt hàng.</small>\n                                            </div>\n                                        )}\n                                    </div>\n                                )}\n                                {!paymentSettings.enable_cod && !paymentSettings.enable_bank && !paymentSettings.enable_ewallet && (\n                                    <div className=\"alert alert-warning\">\n                                        <small>Hiện tại không có phương thức thanh toán nào được kích hoạt. Vui lòng liên hệ admin.</small>\n                                    </div>\n                                )}\n                            </div>\n                            <div className=\"card-footer border-secondary bg-transparent\">\n                                <button\n                                    className=\"btn btn-lg btn-block btn-primary font-weight-bold my-3 py-3\"\n                                    onClick={() => {\n                                        if (!formData.paymentMethod) {\n                                            toast.info('Vui lòng chọn phương thức thanh toán');\n                                            return;\n                                        }\n                                        if (!validateForm()) return;\n                                        handlePlaceOrder();\n                                    }}>Đặt hàng\n                                </button>\n                            </div>\n                        </div>\n\n                    </div>\n                </div>\n            </div>\n\n            <Footer />\n        </Fragment>\n    );\n}\n\nexport default Checkout;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}